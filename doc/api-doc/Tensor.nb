(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    221169,       7229]
NotebookOptionsPosition[    201160,       6575]
NotebookOutlinePosition[    205636,       6708]
CellTagsIndexPosition[    204471,       6675]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Tensor Documentation", "Chapter",
 CellChangeTimes->{{3.6333515346579514`*^9, 3.63335154627586*^9}, {
  3.633364320690548*^9, 3.63336432261762*^9}, {3.633781291117386*^9, 
  3.633781292159832*^9}, {3.633781364287074*^9, 3.633781398056273*^9}, {
  3.6337814322542763`*^9, 3.633781447268347*^9}}],

Cell[CellGroupData[{

Cell["Preamble", "Section",
 CellChangeTimes->{{3.633351558518317*^9, 3.633351560041299*^9}, {
  3.6337812001050663`*^9, 3.633781202247016*^9}}],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<Tensor`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.633351696261045*^9, 3.633351701530016*^9}, {
  3.633781146956828*^9, 3.633781148275402*^9}, {3.633781294331254*^9, 
  3.633781296275483*^9}, {3.633781369011711*^9, 3.633781370275049*^9}, {
  3.633781401233733*^9, 3.633781450090982*^9}}],

Cell["\<\
The following packages are needed to run some code found in this \
documentation notebook.\
\>", "Text",
 CellChangeTimes->{{3.633781139005548*^9, 3.6337811426309013`*^9}}],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<DocTools`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.634323719347743*^9, 3.634323722059269*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Introduction and Overview", "Section",
 CellChangeTimes->{{3.633351563673402*^9, 3.633351567143589*^9}}],

Cell["\<\
This package contains functions for constructing, manipulating and \
contracting states and operators of multipartite systems.\
\>", "Text",
 CellChangeTimes->{{3.634310050150309*^9, 3.634310208369714*^9}, {
  3.634349792591257*^9, 3.6343498682815647`*^9}, {3.634349914343247*^9, 
  3.634349956255692*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrices and Matrix operations", "Section",
 CellChangeTimes->{{3.633352040880207*^9, 3.633352042744746*^9}, {
  3.634310557380536*^9, 3.634310559663636*^9}, {3.6343107475388527`*^9, 
  3.634310749520076*^9}}],

Cell[CellGroupData[{

Cell["CircleTimes", "Subsection",
 CellChangeTimes->{{3.6343107215521727`*^9, 3.634310729011115*^9}}],

Cell[TextData[{
 StyleBox["CircleTimes[", "Input"],
 StyleBox["v1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",...,", "Input"],
 StyleBox["vn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns the vector formed by taking the tensor product of all vectors ",
 StyleBox["v1\[CircleTimes]v2\[CircleTimes]..\[CircleTimes]vn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".",
  FontSlant->"Italic"],
 "\n\n",
 StyleBox["CircleTimes[", "Input"],
 StyleBox["op1,..,opn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns the Array from taking the tensor product of arrays ",
 StyleBox["op1\[CircleTimes]op2\[CircleTimes]..\[CircleTimes]opn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".\n",
  FontSlant->"Italic"],
 "\n",
 StyleBox["CircleTimes[", "Input"],
 StyleBox["op\[Rule]n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns ",
 StyleBox["CircleTimes[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",...,", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " for n copies of ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".\n\n",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["Notes",
  FontWeight->"Bold",
  FontSlant->"Italic",
  FontColor->GrayLevel[0.5]],
 StyleBox["\n\[Bullet]",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" CircleTimes", "Input"],
 StyleBox[" can be shorthanded with the symbol \[CircleTimes], which can be \
typed using the keybard sequence ",
  FontWeight->"Plain"],
 StyleBox["Esc ",
  FontWeight->"Plain",
  Background->RGBColor[1, 1, 0.85]],
 StyleBox["c*", "Input",
  FontWeight->"Plain",
  Background->RGBColor[1, 1, 0.85]],
 StyleBox[" Esc",
  FontWeight->"Plain",
  Background->RGBColor[1, 1, 0.85]],
 StyleBox[".",
  FontWeight->"Plain"]
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311328002417*^9, {3.634316418526174*^9, 3.634316521790423*^9}, {
   3.634509526888596*^9, 3.634509548646995*^9}, {3.634924751102474*^9, 
   3.634924781111176*^9}, {3.6349258561999493`*^9, 3.6349259526860847`*^9}, {
   3.634926269549931*^9, 3.6349262813179913`*^9}, {3.634989908112784*^9, 
   3.634989908825219*^9}},
 CellTags->"CircleTimes::usage"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.6343166954591093`*^9, 3.6343166962902393`*^9}}],

Cell["Tensor product of two vectors", "Text",
 CellChangeTimes->{{3.634316716247079*^9, 3.634316719757729*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"1", ",", "0"}], "}"}], "\[CircleTimes]", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.634316705064439*^9, 3.634316711039897*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6343167114914417`*^9, {3.6349256373455343`*^9, 3.634925662996464*^9}, 
   3.634925782933961*^9}]
}, Open  ]],

Cell["Tensor product of 3 X-gates", "Text",
 CellChangeTimes->{{3.634316724324832*^9, 3.634316734754912*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CircleTimes", "[", 
   RowBox[{
    RowBox[{"TP", "[", "X", "]"}], "->", "3"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634316736393165*^9, 3.634316745949678*^9}, {
  3.634925672944572*^9, 3.634925676697356*^9}, {3.6349257560983973`*^9, 
  3.634925757735321*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "1"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"1", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6343167426883574`*^9, 3.63431674631463*^9}, {
   3.6349256387277813`*^9, 3.634925677352037*^9}, 3.634925783686665*^9}]
}, Open  ]],

Cell["Tensor product of vector with matrix", "Text",
 CellChangeTimes->{{3.6349258070959587`*^9, 3.634925815256929*^9}, {
  3.634925985510036*^9, 3.634925988324211*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TP", "[", "X", "]"}], "\[CircleTimes]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6349258345499163`*^9, 3.634925843931487*^9}, {
  3.634925990716626*^9, 3.634925992455914*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0"},
     {"0", "1"},
     {"0", "0"},
     {"1", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.634925844215228*^9, 3.634925992789897*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[DoubleStruckOne] (IdentityMatrix)", "Subsection",
 CellChangeTimes->{{3.6349234964072857`*^9, 3.634923520445619*^9}, 
   3.634923834856448*^9}],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[DoubleStruckOne]", "n"], " "}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "is shorthand for ",
 StyleBox["IdentityMatrix[n]", "Input"],
 ". The symbol \[DoubleStruckOne] can be typed using the sequence ",
 StyleBox[" ", "Input"],
 StyleBox[Cell[TextData[StyleBox["Esc", "Text",
  FontWeight->"Plain",
  Background->RGBColor[1, 1, 0.85]]], "Input"], "Input"],
 StyleBox["\[ThinSpace]ds1\[ThinSpace]", "Input"],
 StyleBox[Cell[TextData[StyleBox["Esc", "Text",
  FontWeight->"Plain",
  Background->RGBColor[1, 1, 0.85]]], "Input"], "Input"],
 ", and the subscript can be initiated with the shortcut ",
 StyleBox["Ctrl+Shift+_",
  Background->RGBColor[1, 1, 0.85]],
 ". The expression ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[DoubleStruckOne]", "n"], " "}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "in ",
 StyleBox["FullForm", "Input"],
 " is given by ",
 StyleBox["Subscript[\[DoubleStruckOne],n]", "Input"],
 "."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{{3.634923522706259*^9, 3.6349235857598047`*^9}, {
  3.63492362725347*^9, 3.634923803415079*^9}, {3.634924679103196*^9, 
  3.634924723178679*^9}, {3.6349247862955637`*^9, 3.634924826013873*^9}, {
  3.634924907487076*^9, 3.634924909096919*^9}, {3.634926004459416*^9, 
  3.634926005281067*^9}, {3.6349262878205147`*^9, 3.634926313679575*^9}, {
  3.634989898160452*^9, 3.6349898986805487`*^9}, {3.634990086887166*^9, 
  3.634990113203055*^9}},
 CellTags->"IdentityMatrixShorthand::usage"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.6349238410359*^9, 3.6349238417549543`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox["\[DoubleStruckOne]", "3"]], "Input",
 CellChangeTimes->{{3.634923844289794*^9, 3.6349238476497107`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.634925051503069*^9, {3.6349257884952908`*^9, 3.634925792769113*^9}, 
   3.634926121046321*^9, 3.634989959295082*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TP", "[", "X", "]"}], "\[CircleTimes]", 
   SubscriptBox["\[DoubleStruckOne]", "2"]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634989938443746*^9, 3.6349899687492857`*^9}, {
  3.634990049365137*^9, 3.63499005744967*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"},
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6349899456914253`*^9, 3.634989969558889*^9}, {
  3.6349900556366987`*^9, 3.6349900578973103`*^9}}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["ArrayPermutations", "Subsection",
 CellChangeTimes->{{3.634310810427404*^9, 3.634310812373498*^9}, 
   3.634310973563674*^9}],

Cell[TextData[{
 StyleBox["ArrayPermutations[{", "Input"],
 StyleBox["A1,n1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["A2,n2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},...,{", "Input"],
 StyleBox["Ak,nk", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}]", "Input"],
 " returns a sum of all permutations of ",
 StyleBox["CircleTimes", "Input"],
 " of ",
 StyleBox["nj", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " copies of ",
 StyleBox["Aj", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ", for j=1 to n."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.6343112851955433`*^9, {3.634316561728455*^9, 3.634316588222616*^9}},
 CellTags->"ArrayPermutations::usage"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.634316596154511*^9, 3.634316596840386*^9}}],

Cell["To return \
X\[CircleTimes]I\[CircleTimes]I+I\[CircleTimes]X\[CircleTimes]I+I\
\[CircleTimes]I\[CircleTimes]X", "Text",
 CellChangeTimes->{{3.634316626433573*^9, 3.634316649556919*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ArrayPermutations", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TP", "[", "I", "]"}], ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TP", "[", "X", "]"}], ",", "1"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634316597826398*^9, 3.634316622344578*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "1", "0", "1", "0", "0", "0"},
     {"1", "0", "0", "1", "0", "1", "0", "0"},
     {"1", "0", "0", "1", "0", "0", "1", "0"},
     {"0", "1", "1", "0", "0", "0", "0", "1"},
     {"1", "0", "0", "0", "0", "1", "1", "0"},
     {"0", "1", "0", "0", "1", "0", "0", "1"},
     {"0", "0", "1", "0", "1", "0", "0", "1"},
     {"0", "0", "0", "1", "0", "1", "1", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634316618629345*^9, 3.634316622711783*^9}}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["SwapMatrix", "Subsection",
 CellChangeTimes->{{3.63431080413785*^9, 3.634310805342319*^9}, 
   3.634310974879772*^9}],

Cell[TextData[{
 StyleBox["SwapMatrix[{", "Input"],
 StyleBox["d1,...,dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["i1,...,in", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}]", "Input"],
 " returns the permutation matrix for mapping a subsystem ",
 StyleBox["k", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " with dimension ",
 StyleBox["dk", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ", to subsystem ",
 StyleBox["ik", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ".\n\n",
 StyleBox["SwapMatrix[", "Input"],
 StyleBox["d", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",{", "Input"],
 StyleBox["i1,...,in", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}] ", "Input"],
 "returns the permutation matrix for mapping a subsystem ",
 StyleBox["k", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " to subsystem ",
 StyleBox["ik", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " where all subsystems have dimension ",
 StyleBox["d", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ".\n\n",
 StyleBox["SwapMatrix[{", "Input"],
 StyleBox["d1,...,dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["i1,...,in", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},SparseArray]", "Input"],
 "and ",
 StyleBox["SwapMatrix[", "Input"],
 StyleBox["d", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",{", "Input"],
 StyleBox["i1,...,in", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},SparseArray] ", "Input"],
 "returns the permutation matrix as a ",
 StyleBox["SparseArray", "Input"],
 "."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311280729559*^9, 3.634316794434973*^9, {3.6343168269251223`*^9, 
   3.634316915295806*^9}},
 CellTags->"SwapMatrix::usage"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.634316756669258*^9, 3.634316757344146*^9}}],

Cell["2-qubit Swap gate", "Text",
 CellChangeTimes->{{3.634316758580884*^9, 3.634316764622871*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SwapMatrix", "[", 
   RowBox[{"2", ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6343167658167562`*^9, 3.634316784940782*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634316771475271*^9, 3.634316785144226*^9}}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["BlockMatrix", "Subsection",
 CellChangeTimes->{{3.6343107352332087`*^9, 3.634310736975686*^9}, 
   3.6343109763759604`*^9}],

Cell[TextData[{
 StyleBox["BlockMatrix[", "Input"],
 StyleBox["B1,B2,...,Bn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns the diagonal block matrix of the input matrices ",
 StyleBox["B1,B2,...,Bn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".",
  FontWeight->"Plain",
  FontSlant->"Italic"]
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.6343113232100773`*^9, {3.6343170399354277`*^9, 3.6343170789715157`*^9}},
 CellTags->"BlockMatrix::usage"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.634317084360384*^9, 3.6343170850700483`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BlockMatrix", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", 
    RowBox[{"Array", "[", 
     RowBox[{"b", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}]}], "]"}], ",", 
    RowBox[{"Array", "[", 
     RowBox[{"c", ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634317085840761*^9, 3.634317115276587*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"a", "[", 
       RowBox[{"1", ",", "1"}], "]"}], "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{"b", "[", 
       RowBox[{"1", ",", "1"}], "]"}], 
      RowBox[{"b", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "0", "0", "0"},
     {"0", 
      RowBox[{"b", "[", 
       RowBox[{"2", ",", "1"}], "]"}], 
      RowBox[{"b", "[", 
       RowBox[{"2", ",", "2"}], "]"}], "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "1"}], "]"}], 
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "2"}], "]"}], 
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "3"}], "]"}]},
     {"0", "0", "0", 
      RowBox[{"c", "[", 
       RowBox[{"2", ",", "1"}], "]"}], 
      RowBox[{"c", "[", 
       RowBox[{"2", ",", "2"}], "]"}], 
      RowBox[{"c", "[", 
       RowBox[{"2", ",", "3"}], "]"}]},
     {"0", "0", "0", 
      RowBox[{"c", "[", 
       RowBox[{"3", ",", "1"}], "]"}], 
      RowBox[{"c", "[", 
       RowBox[{"3", ",", "2"}], "]"}], 
      RowBox[{"c", "[", 
       RowBox[{"3", ",", "3"}], "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.634317115675673*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["UnitArray", "Subsection",
 CellChangeTimes->{{3.634310781740144*^9, 3.634310784765884*^9}, {
  3.634310977647337*^9, 3.634310979987252*^9}}],

Cell[TextData[{
 StyleBox["UnitArray[{", "Input"],
 StyleBox["d1,...,dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["i1,...,in", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}]", "Input"],
 " returns the unit rank-",
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " array of dimension ",
 StyleBox["{", "Input"],
 StyleBox["d1,...,dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 " with a 1 at index ",
 StyleBox["{", "Input"],
 StyleBox["i1,...,in", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 " and zeros elsewhere.\n",
 StyleBox["UnitArray[{", "Input"],
 StyleBox["d1,...,dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["i1,...,in", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}, SparseArray]", "Input"],
 " returns the unit array as a ",
 StyleBox["SparseArray", "Input"],
 "."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311290955184*^9, {3.634317188314958*^9, 3.634317226280287*^9}},
 CellTags->"UnitArray::usage"],

Cell[CellGroupData[{

Cell["Examples", "Subsubsection",
 CellChangeTimes->{{3.634317232140891*^9, 3.634317233052122*^9}}],

Cell["Elementary Matrix", "Text",
 CellChangeTimes->{{3.634317236797583*^9, 3.634317240544561*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"UnitArray", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"3", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6343172337674093`*^9, 3.634317252155806*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0"},
     {"0", "0", "1"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.634317252522203*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Com and ACom", "Subsection",
 CellChangeTimes->{{3.634310739888934*^9, 3.6343107593858128`*^9}, {
  3.6343114120583*^9, 3.634311416084159*^9}}],

Cell[TextData[{
 StyleBox["Com[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns the commutator ",
 StyleBox["[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]=", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["-", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" ", "Input"],
 "of matrices ",
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " and ",
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ".\n",
 StyleBox["Com[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns the nested commutator",
 StyleBox["  [", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",...[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]...]]=Com[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",Com[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["n-1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]]", "Input"],
 "of matrices ",
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " and ",
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" ",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["where ",
  FontWeight->"Plain"],
 StyleBox["Com[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",0]=", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[", and ",
  FontWeight->"Plain"],
 StyleBox["Com[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",1]=Com[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 "."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311311339786*^9, {3.634317277413248*^9, 3.63431748303874*^9}, {
   3.634317529357958*^9, 3.634317531898181*^9}, {3.634317597260312*^9, 
   3.634317598476801*^9}},
 CellTags->"Com::usage"],

Cell[TextData[{
 StyleBox["ACom[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns the anti-commutator ",
 StyleBox["{", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}=", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["+", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" ", "Input"],
 "of matrices ",
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " and ",
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ".\n",
 StyleBox["ACom[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns the nested anti-commutator",
 StyleBox[" {", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",{", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",...{", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}...}}=ACom[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",ACom{", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["n-1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]]", "Input"],
 "of matrices ",
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " and ",
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" ",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["where ",
  FontWeight->"Plain"],
 StyleBox["ACom[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",0]=", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[", and ",
  FontWeight->"Plain"],
 StyleBox["ACom[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",1]=ACom[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 "."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311316190063*^9, {3.634317539732061*^9, 3.6343176165458317`*^9}},
 CellTags->"ACom::usage"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.6343177063640203`*^9, 3.6343177075006657`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Com", "[", 
   RowBox[{
    RowBox[{"TP", "[", "X", "]"}], ",", 
    RowBox[{"TP", "[", "Y", "]"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634317709973526*^9, 3.634317719470849*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"2", " ", "\[ImaginaryI]"}], "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", "2"}], " ", "\[ImaginaryI]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634317715374281*^9, 3.634317719810995*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Com", "[", 
   RowBox[{
    RowBox[{"TP", "[", "X", "]"}], ",", 
    RowBox[{"TP", "[", "Y", "]"}], ",", "3"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634317720838813*^9, 3.634317733713531*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"8", " ", "\[ImaginaryI]"}], "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", "8"}], " ", "\[ImaginaryI]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634317726407619*^9, 3.634317734061287*^9}}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["OuterProduct and Projector", "Subsection",
 CellChangeTimes->{{3.634310765820191*^9, 3.6343107737409554`*^9}, {
  3.634310982597848*^9, 3.63431099021356*^9}}],

Cell[TextData[{
 StyleBox["OuterProduct[", "Input"],
 StyleBox["vec1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["vec2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["] ", "Input"],
 "returns the matrix ",
 StyleBox["vec1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["\[CircleTimes]", "Input"],
 StyleBox["vec2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["\[HermitianConjugate]", "Input"],
 " formed by taking the outer product of two vectors ",
 StyleBox["vec1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["vec2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 "."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.6343113040391827`*^9, {3.634317627433009*^9, 3.6343176544229927`*^9}},
 CellTags->"OuterProduct::usage"],

Cell[TextData[{
 StyleBox["Projector[", "Input"],
 StyleBox["vec", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 "returns the rank-1 projector ",
 StyleBox["OuterProduct[", "Input"],
 StyleBox["vec", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["vec", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]=", "Input"],
 StyleBox["vec", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["\[CircleTimes]", "Input"],
 StyleBox["vec", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["\[HermitianConjugate]", "Input"],
 "."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311297818637*^9, {3.634317662364491*^9, 3.6343176913780212`*^9}},
 CellTags->"Projector::usage"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.6343177439169188`*^9, 3.634317744603284*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"OuterProduct", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", "2"}], "]"}], ",", 
    RowBox[{"Array", "[", 
     RowBox[{"b", ",", "2"}], "]"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634317745837935*^9, 3.6343177563038*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"a", "[", "1", "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", "1", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", "1", "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", "2", "]"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", "2", "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", "1", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", "2", "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", "2", "]"}], "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634317753096154*^9, 3.634317756642015*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", "3"}], "]"}], "]"}], "//", "FullSimplify"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634317758675139*^9, 3.6343177708515463`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SuperscriptBox[
       RowBox[{"Abs", "[", 
        RowBox[{"a", "[", "1", "]"}], "]"}], "2"], 
      RowBox[{
       RowBox[{"a", "[", "1", "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"a", "[", "2", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", "1", "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"a", "[", "3", "]"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", "2", "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"a", "[", "1", "]"}], "]"}]}], 
      SuperscriptBox[
       RowBox[{"Abs", "[", 
        RowBox[{"a", "[", "2", "]"}], "]"}], "2"], 
      RowBox[{
       RowBox[{"a", "[", "2", "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"a", "[", "3", "]"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", "3", "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"a", "[", "1", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", "3", "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"a", "[", "2", "]"}], "]"}]}], 
      SuperscriptBox[
       RowBox[{"Abs", "[", 
        RowBox[{"a", "[", "3", "]"}], "]"}], "2"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634317765181858*^9, 3.634317771158102*^9}}]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tensor Product Parser", "Section",
 CellChangeTimes->{{3.634310871446907*^9, 3.634310874991136*^9}}],

Cell[CellGroupData[{

Cell["TP Parser", "Subsection",
 CellChangeTimes->{{3.634310887276719*^9, 3.634310891236371*^9}}],

Cell[TextData[{
 StyleBox["TP[", "Input"],
 StyleBox["expr", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["opts", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " parses an input expression and returns the tensor product of matrices with \
appropriate coefficients. Allowed operators are ",
 StyleBox["+ - *", "Input"],
 " for addition and subtraction, and scalar multiplication, numbers or \
symbols for scalar factors, ",
 StyleBox["i", "Input"],
 " for for the imaginary number and any expressions to be converted to Arrays \
as specified specified by the option ",
 StyleBox["Replace", "Input"],
 ".\n\n",
 StyleBox["Options",
  FontWeight->"Bold",
  FontSlant->"Italic",
  FontColor->GrayLevel[0.5]],
 "\n\[Bullet] ",
 StyleBox["Replace\[Rule]", "Input"],
 StyleBox["rules", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" ", "Input"],
 "specifies the strings to be replaced by matrices. It must be a list of \
Rules  ",
 StyleBox["str", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["\[Rule]", "Input"],
 StyleBox["op ", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 "where ",
 StyleBox["str", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " is a ",
 StyleBox["String", "Input"],
 "  and ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " is the operator the string will be replaced by in ",
 StyleBox["expr", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ". The default includes the identity (I), Pauli X,Y,Z, Hadamard (H), phase \
(S), and \[Pi]/8 (T) gates, and projectors |0\[RightAngleBracket]\
\[LeftAngleBracket]0| (P), and |1\[RightAngleBracket]\[LeftAngleBracket]1| \
(M) and is given by:\n",
 StyleBox["{\[OpenCurlyDoubleQuote]I\[CloseCurlyDoubleQuote]\[Rule]\
PauliMatrix[0], \
\[OpenCurlyDoubleQuote]X\[CloseCurlyDoubleQuote]\[Rule]PauliMatrix[1],\
\[CloseCurlyDoubleQuote]Y\[CloseCurlyDoubleQuote]\[Rule]PauliMatrix[2],\
\[CloseCurlyDoubleQuote]Z\[CloseCurlyDoubleQuote]\[Rule]PauliMatrix[3], \
\[OpenCurlyDoubleQuote]P\[CloseCurlyDoubleQuote]\[Rule]{{0,1},{0,0}}, \
\[OpenCurlyDoubleQuote]M\[CloseCurlyDoubleQuote]\[Rule]{{0,0},{1,0}}, \
\[OpenCurlyDoubleQuote]U\[CloseCurlyDoubleQuote]\[Rule]{{1,0},{0,0}}, \
\[OpenCurlyDoubleQuote]D\[CloseCurlyDoubleQuote]\[Rule]{{0,0},{0,1}}, \
\[CloseCurlyDoubleQuote]H\[CloseCurlyDoubleQuote]\[Rule]{{1,1},{1,-1}}/Sqrt[2]\
, \[OpenCurlyDoubleQuote]S\[CloseCurlyDoubleQuote]\[Rule]{{1,0},{0,I}}, \
\[OpenCurlyDoubleQuote]T\[CloseCurlyDoubleQuote]\[Rule]{{1,0},{0,Exp[I*Pi/4]}}\
}", "Input"],
 ".\n\n\[Bullet] ",
 StyleBox["Method\[Rule]", "Input"],
 StyleBox["fun", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " specifies the function ",
 StyleBox["fun", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " to be used by TP to combine operators. The default value is ",
 StyleBox["CircleTimes", "Input"],
 ".\n\n",
 StyleBox["Attributes",
  FontWeight->"Bold",
  FontSlant->"Italic",
  FontColor->GrayLevel[0.5]],
 "\n",
 StyleBox["TP", "Input"],
 " has attributes ",
 StyleBox["HoldFirst", "Input"],
 " and immediately converts the input ",
 StyleBox["expr", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " into a string before any evaluation occurs. Hence ",
 StyleBox["expr", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " may be a string, or an expression of symbols and in the later case it will \
ignore any definitions associated to those symbols."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634310902718301*^9, {3.6343253345275593`*^9, 3.634326004885202*^9}, {
   3.634326069793248*^9, 3.634326071279565*^9}, {3.634326105259543*^9, 
   3.6343262298426027`*^9}},
 CellTags->"TP::usage"],

Cell[CellGroupData[{

Cell["Options", "Subsubsection",
 CellChangeTimes->{{3.6343109070325747`*^9, 3.6343109076839952`*^9}}],

Cell[BoxData[
 RowBox[{"DisplayOptions", "[", "TP", "]"}]], "Input",
 CellChangeTimes->{{3.6343260120398197`*^9, 3.6343260148381042`*^9}}],

Cell[BoxData[GridBox[{
   {
    StyleBox["Option", "Text",
     FontWeight->Bold], 
    StyleBox[
     RowBox[{"Default", " ", "Value"}], "Text",
     FontWeight->Bold], 
    StyleBox["Description", "Text",
     FontWeight->Bold]},
   {"Method", "CircleTimes", 
    StyleBox[
     RowBox[{
     "Specifies", " ", "the", " ", "function", " ", "used", " ", "to", " ", 
      "combine", " ", "elements", " ", "in", " ", "the", " ", "TP", " ", 
      RowBox[{"parser", "."}]}], "Text"]},
   {"Replace", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<X\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"\"\<Y\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "\[ImaginaryI]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[ImaginaryI]", ",", "0"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"\"\<Z\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"\"\<I\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"\"\<P\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"\"\<M\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"\"\<U\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"\"\<D\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"\"\<H\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           FractionBox["1", 
            SqrtBox["2"]], ",", 
           FractionBox["1", 
            SqrtBox["2"]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox["1", 
            SqrtBox["2"]], ",", 
           RowBox[{"-", 
            FractionBox["1", 
             SqrtBox["2"]]}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"\"\<S\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "\[ImaginaryI]"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"\"\<T\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]]}], "}"}]}], 
        "}"}]}]}], "}"}], 
    StyleBox[
     RowBox[{
     "Specifies", " ", "the", " ", "replacement", " ", "rules", " ", "for", 
      " ", "parsing", " ", "an", " ", "input", " ", 
      RowBox[{"expression", "."}]}], "Text"]}
  },
  GridBoxAlignment->{"Columns" -> {{Left}}},
  GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{True}}},
  GridBoxItemSize->{"Columns" -> {Automatic, Automatic, {
       Scaled[0.5]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
    "RowsIndexed" -> {}}]], "Text",
 CellChangeTimes->{{3.634326024046686*^9, 3.6343260512004957`*^9}, {
  3.6343260815569143`*^9, 3.634326094074238*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.634310908943316*^9, 3.634310909978795*^9}, {
  3.634326355797537*^9, 3.634326355971631*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TP", "[", 
   RowBox[{"aXX", "+", "bYY"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634325438997239*^9, 3.6343254403526506`*^9}, {
  3.634326237079976*^9, 3.634326257987918*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", 
      RowBox[{"a", "-", "b"}]},
     {"0", "0", 
      RowBox[{"a", "+", "b"}], "0"},
     {"0", 
      RowBox[{"a", "+", "b"}], "0", "0"},
     {
      RowBox[{"a", "-", "b"}], "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.634325440699271*^9, {3.6343262519623117`*^9, 3.6343262584822617`*^9}}]
}, Open  ]],

Cell["\<\
If no defined inputs are detected everything is treated as multiplication\
\>", "Text",
 CellChangeTimes->{{3.634326363970717*^9, 3.634326384619246*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TP", "[", 
  RowBox[{"abc", "+", 
   RowBox[{"3", "xy"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.634326386476253*^9, 3.634326391109336*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", " ", "b", " ", "c"}], "+", 
  RowBox[{"3", " ", "x", " ", "y"}]}]], "Output",
 CellChangeTimes->{3.634326391718445*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix-Tensor Manipulations", "Section",
 CellChangeTimes->{{3.634310842692814*^9, 3.634310845707429*^9}}],

Cell[CellGroupData[{

Cell["MatrixToTensor", "Subsection",
 CellChangeTimes->{{3.6343111988578568`*^9, 3.6343112006351967`*^9}}],

Cell[TextData[{
 StyleBox["MatrixToTensor[", "Input"],
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",{{", "Input"],
 StyleBox["dL1,...,dLn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["dR1,...,dRk", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}}]", "Input"],
 " transforms the matrix ",
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " with ",
 StyleBox["Dimensions", "Input"],
 " ",
 StyleBox["{", "Input"],
 StyleBox["dL1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["*...*", "Input"],
 StyleBox["dLn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[", ", "Input"],
 StyleBox["dR1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["*...*", "Input"],
 StyleBox["dRk", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 " into a a rank-",
 StyleBox["(n+k)", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " tensor.\n\n",
 StyleBox["MatrixToTensor[", "Input"],
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",{", "Input"],
 StyleBox["d1,...,dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}]", "Input"],
 " transforms the matrix ",
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " with ",
 StyleBox["Dimensions", "Input"],
 " ",
 StyleBox["{", "Input"],
 StyleBox["d1*...*dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[", ", "Input"],
 StyleBox["d1*...*dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 " into a a rank-",
 StyleBox["2n.", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 "\n\n",
 StyleBox["MatrixToTensor[", "Input"],
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",{", "Input"],
 StyleBox["d1,...,dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}]", "Input"],
 " transforms the matrix ",
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " with Flattened dimensions ",
 StyleBox["d1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["*...*", "Input"],
 StyleBox["dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " into a a rank-",
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " tensor."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311207861146*^9, {3.634318337804388*^9, 3.6343186029760647`*^9}},
 CellTags->"MatrixToTensor::usage"],

Cell[CellGroupData[{

Cell["Example 1", "Subsubsection",
 CellChangeTimes->{{3.634318670436749*^9, 3.6343186718608*^9}}],

Cell["\<\
Converting an array of mixed dimensional subsystems into a tensor:\
\>", "Text",
 CellChangeTimes->{{3.6343187059182367`*^9, 3.634318718117638*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MatrixToTensor", "[", 
  RowBox[{
   RowBox[{"Array", "[", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "6"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "ArrayDepth"}]}], "Input",
 CellChangeTimes->{{3.634318672517428*^9, 3.6343186951823807`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "1"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "2"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "4"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "5"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "6"}], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "1"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "2"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "4"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "5"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "6"}], "]"}]}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "1"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "2"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "3"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "5"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "6"}], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "1"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "2"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "3"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "4"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "5"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "6"}], "]"}]}], "}"}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6343186875628157`*^9, 3.634318695822191*^9}}],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{{3.6343186875628157`*^9, 3.63431869582911*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Example 2", "Subsubsection",
 CellChangeTimes->{{3.634318721199524*^9, 3.6343187235505342`*^9}}],

Cell["Converting a bipartite matrix into a tensor", "Text",
 CellChangeTimes->{{3.634318727654437*^9, 3.634318733390873*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MatrixToTensor", "[", 
  RowBox[{
   RowBox[{"Array", "[", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "ArrayDepth"}]}], "Input",
 CellChangeTimes->{{3.634318738705579*^9, 3.634318744185753*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "1"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "2"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "3"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "4"}], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "1"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "2"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "3"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "4"}], "]"}]}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "1"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "2"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "3"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "4"}], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "1"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "2"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "3"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "4"}], "]"}]}], "}"}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.634318744701151*^9}],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{3.6343187447077007`*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["MatrixTranspose", "Subsection",
 CellChangeTimes->{{3.634311211120685*^9, 3.634311212965885*^9}}],

Cell[TextData[{
 StyleBox["MatrixTranspose[", "Input"],
 StyleBox["mat,dims,perm", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " yields the matrix resulting from applying the tensor transpose descriped \
by ",
 StyleBox["perm", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " to the multipartite matrix ",
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ". \n\[Bullet] ",
 StyleBox["dims", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " specifies the dimensions of subsystems and may be listed in any of the \
forms allowed by ",
 StyleBox["MatrixToTensor", "Input"],
 ".\n\[Bullet] ",
 StyleBox["perms", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " is the same argument as used by ",
 StyleBox["TensorTranspose", "Input"],
 " where the labelling of subsystem indicies starts from the first left-index \
thorugh to the last left-index followed by the first right index through to \
the last right-index."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311220033101*^9, {3.63431861120216*^9, 3.634318612888997*^9}, {
   3.634318779289822*^9, 3.6343188718604183`*^9}, {3.634319715596946*^9, 
   3.634319752645644*^9}, {3.634322530548225*^9, 3.634322804994173*^9}},
 CellTags->"MatrixTranspose::usage"],

Cell[CellGroupData[{

Cell["Example 1", "Subsubsection",
 CellChangeTimes->{{3.634322496819581*^9, 3.6343224981390543`*^9}}],

Cell["\<\
Implememt a partial transpose of subsystem 1 or a bipartite matrix:\
\>", "Text",
 CellChangeTimes->{{3.6343225001078463`*^9, 3.634322516163024*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MatrixTranspose", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Array", "[", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "\[CircleTimes]", 
     RowBox[{"Array", "[", 
      RowBox[{"b", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "2", ",", "1", ",", "4"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634322518028305*^9, 3.634322521764483*^9}, {
  3.634322809687311*^9, 3.634322861568741*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634322844433599*^9, 3.6343228507821407`*^9}}]
}, Open  ]],

Cell["Check the answer", "Text",
 CellChangeTimes->{{3.634322872341199*^9, 3.63432287754084*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Array", "[", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "\[Transpose]"}], 
    "\[CircleTimes]", 
    RowBox[{"Array", "[", 
     RowBox[{"b", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "-", 
   RowBox[{"MatrixTranspose", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Array", "[", 
       RowBox[{"a", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "\[CircleTimes]", 
      RowBox[{"Array", "[", 
       RowBox[{"b", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2", ",", "1", ",", "4"}], "}"}]}], "]"}]}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634322883954399*^9, 3.63432289881446*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634322888684841*^9, 3.634322899155798*^9}}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Swap", "Subsection",
 CellChangeTimes->{{3.6343112271179*^9, 3.634311227623914*^9}}],

Cell[TextData[{
 StyleBox["Swap[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",{", "Input"],
 StyleBox["d1,...,dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},", "Input"],
 StyleBox["perm", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["] ", "Input"],
 "returns the result of permuting the matrix or vector ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" ",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["on ",
  FontWeight->"Plain"],
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" subsystems ",
  FontWeight->"Plain"],
 "according to the ordering specified by ",
 StyleBox["perm", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " ,",
 StyleBox[" where subsystem ",
  FontWeight->"Plain"],
 StyleBox["j", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" has dimension ",
  FontWeight->"Plain"],
 StyleBox["dj", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 "\n\n",
 StyleBox["Swap[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["d", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["perm", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["] ", "Input"],
 "returns the result of permuting the matrix or vector ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" ",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["on ",
  FontWeight->"Plain"],
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" subsystems ",
  FontWeight->"Plain"],
 "according to the ordering specified by ",
 StyleBox["perm", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " ,",
 StyleBox[" where each subsystem has dimension ",
  FontWeight->"Plain"],
 StyleBox["d", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".\n\n",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["Swap[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["perm", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 StyleBox[" returns ",
  FontWeight->"Plain"],
 StyleBox["Swap[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["perm", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 StyleBox[".",
  FontWeight->"Plain"]
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311231947031*^9, {3.634318615466152*^9, 3.634318617121394*^9}, {
   3.6343230569066133`*^9, 3.634323319178636*^9}},
 CellTags->"Swap::usage"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.6343229151027927`*^9, 3.634322916006151*^9}, {
  3.634323031466917*^9, 3.634323035378474*^9}}],

Cell["Swap two subsystems", "Text",
 CellChangeTimes->{{3.634322920965261*^9, 3.634322924678784*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Swap", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Array", "[", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "\[CircleTimes]", 
     RowBox[{"Array", "[", 
      RowBox[{"b", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634322927767591*^9, 3.634322993754284*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"3", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"3", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"3", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"3", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"3", ",", "3"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"3", ",", "3"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"3", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"3", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"3", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"3", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"3", ",", "3"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"3", ",", "3"}], "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634322945911104*^9, 3.634322994115757*^9}}]
}, Open  ]],

Cell["Check Solution is correct", "Text",
 CellChangeTimes->{{3.6343229973615923`*^9, 3.6343230230181627`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Array", "[", 
    RowBox[{"b", ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3"}], "}"}]}], "]"}], "\[CircleTimes]", 
   RowBox[{"Array", "[", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "-", 
  RowBox[{"Swap", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Array", "[", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "\[CircleTimes]", 
     RowBox[{"Array", "[", 
      RowBox[{"b", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.634323009590301*^9, 3.6343230170098467`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.634323017197439*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reshuffle", "Subsection",
 CellChangeTimes->{{3.6343112381666803`*^9, 3.634311239875751*^9}}],

Cell[TextData[{
 StyleBox["Column Reshuffling",
  FontWeight->"Bold",
  FontSlant->"Italic",
  FontColor->GrayLevel[0.5]],
 StyleBox["\nReshuffle[", "Input"],
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",{", "Input"],
 StyleBox["dl1,dl2,dr1,dr2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}] ", "Input"],
 "returns the column reshuffling of the bipartite matrix ",
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " with dimensions ",
 StyleBox["{", "Input"],
 StyleBox["dl1*dl2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[", ", "Input"],
 StyleBox["r1*dr2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 ". This operation corresponds to ",
 StyleBox["MatrixTranspose", "Input"],
 " operation with ",
 StyleBox["perm", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["={", "Input"],
 StyleBox["4,2,3,1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 ".\n\n",
 StyleBox["Reshuffle[", "Input"],
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["] r", "Input"],
 "eturns the column reshuffling of the bipartite square matrix ",
 StyleBox["mat ", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["where both subsystems have the same dimension.",
  FontWeight->"Plain"],
 "\n\n",
 StyleBox["Row Reshuffling",
  FontWeight->"Bold",
  FontSlant->"Italic",
  FontColor->GrayLevel[0.5]],
 "\n",
 StyleBox["Reshuffle[", "Input"],
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",{", "Input"],
 StyleBox["dl1,dl2,dr1,dr2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},Basis\[Rule]\[CloseCurlyDoubleQuote]Row\[CloseCurlyDoubleQuote]] \
", "Input"],
 "returns the row reshuffling of the bipartite matrix ",
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " with dimensions ",
 StyleBox["{", "Input"],
 StyleBox["dl1*dl2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[", ", "Input"],
 StyleBox["r1*dr2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 ". This operation corresponds to ",
 StyleBox["MatrixTranspose", "Input"],
 " operation with ",
 StyleBox["perm", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["={", "Input"],
 StyleBox["1,3,2,4", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 ".\n\n",
 StyleBox["Reshuffle[", "Input"],
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",Basis\[Rule]\[CloseCurlyDoubleQuote]Row\[CloseCurlyDoubleQuote]] \
", "Input"],
 "returns the row reshuffling of the bipartite square matrix ",
 StyleBox["mat ", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["where both subsystems have the same dimension.",
  FontWeight->"Plain"]
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311242646834*^9, {3.634318620402426*^9, 3.6343186205213213`*^9}, {
   3.634323369809149*^9, 3.634323494777597*^9}, {3.634323551536936*^9, 
   3.6343237145154457`*^9}, {3.63432393204455*^9, 3.634323972956599*^9}},
 CellTags->"Reshuffle::usage"],

Cell[CellGroupData[{

Cell["Options", "Subsubsection",
 CellChangeTimes->{{3.634323733450584*^9, 3.634323734043366*^9}}],

Cell[BoxData[GridBox[{
   {
    StyleBox["Option", "Text",
     FontWeight->Bold], 
    StyleBox[
     RowBox[{"Default", " ", "Value"}], "Text",
     FontWeight->Bold], 
    StyleBox["Description", "Text",
     FontWeight->Bold]},
   {"Basis", "\"\<Col\>\"", 
    StyleBox[
     RowBox[{
     "Specifies", " ", "the", " ", "type", " ", "of", " ", "reshuffling", " ",
       "operation", " ", "corresponding", " ", "to", " ", "the", " ", 
      "vectorization", " ", 
      RowBox[{"basis", ".", " ", "Allowed"}], " ", "values", " ", "are", " ", 
      "\!\(\*\"\\\"\"\)\!\(\*\"Col\"\)\!\(\*\"\\\"\"\)", " ", "or", " ", 
      RowBox[{"\!\(\*\"\\\"\"\)\!\(\*\"Row\"\)\!\(\*\"\\\"\"\)", "."}]}], 
     "Text"]}
  },
  GridBoxAlignment->{"Columns" -> {{Left}}},
  GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{True}}},
  GridBoxItemSize->{"Columns" -> {Automatic, Automatic, {
       Scaled[0.5]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
    "RowsIndexed" -> {}}]], "Text",
 CellChangeTimes->{{3.634323847805462*^9, 3.63432389828652*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.6343239780061893`*^9, 3.634323978957386*^9}}],

Cell["\<\
Showing that Reshuffling can be expressed as MatrixTranspose:\
\>", "Text",
 CellChangeTimes->{{3.6343240737899513`*^9, 3.634324083309002*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Reshuffle", "[", 
   RowBox[{"Array", "[", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "]"}], "]"}], "-", 
  RowBox[{"MatrixTranspose", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "2", ",", "3", ",", "1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.634323497922716*^9, 3.634323537757737*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6343235125663652`*^9, 3.6343235382258053`*^9}, 
   3.634324565590424*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Reshuffle", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"Basis", "\[Rule]", "\"\<Row\>\""}]}], "]"}], "-", 
  RowBox[{"MatrixTranspose", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.634323497922716*^9, 3.634323537757737*^9}, {
  3.634324088784284*^9, 3.634324098326942*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.634324098774249*^9, 3.634324162825457*^9, {3.634324539834733*^9, 
   3.634324561120493*^9}}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Unravel", "Subsection",
 CellChangeTimes->{{3.634311250315641*^9, 3.634311251058013*^9}}],

Cell[TextData[{
 StyleBox["Unravel[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",{", "Input"],
 StyleBox["d1,..,dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}]", "Input"],
 " applies the unravelling operation ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " where ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " may be a vector or matrix on ",
 StyleBox["2n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " subsystems where two subsystems have dimension ",
 StyleBox["dj", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " for each ",
 StyleBox["j", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ". It transforms an operator ",
 StyleBox["a1\[CircleTimes]....\[CircleTimes]an\[CircleTimes]b1\[CircleTimes].\
..\[CircleTimes]bn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " into an operator ",
 StyleBox["a1\[CircleTimes]b1\[CircleTimes]...\[CircleTimes]an\[CircleTimes]\
bn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ".\n\n",
 StyleBox["Unravel[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["d", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " applies the unravelling operation ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " where all subsystems are assumed to have dimension ",
 StyleBox["d", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ".\n\n",
 StyleBox["Unravel[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " assums ",
 StyleBox["d=2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" and returns ",
  FontWeight->"Plain"],
 StyleBox["Unravel[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",2]", "Input"],
 StyleBox[".\n\n",
  FontWeight->"Plain"],
 StyleBox["Unravel[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["dims,", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["Unravel\[Rule]False]", "Input"],
 " returns the reravelling operation ",
 StyleBox["Reravel[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["dims", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 ". See ",
 StyleBox["Reravel", "Input"],
 " for further details."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311252963114*^9, {3.6343186231227503`*^9, 3.634318624780232*^9}, {
   3.634324588013916*^9, 3.634324864864793*^9}, {3.634324903896451*^9, 
   3.634325063785513*^9}, {3.634325104199978*^9, 3.63432510896889*^9}},
 CellTags->"Unravel::usage"],

Cell[CellGroupData[{

Cell["Options", "Subsubsection",
 CellChangeTimes->{{3.634325136625819*^9, 3.634325137289431*^9}}],

Cell[BoxData[GridBox[{
   {
    StyleBox["Option", "Text",
     FontWeight->Bold], 
    StyleBox[
     RowBox[{"Default", " ", "Value"}], "Text",
     FontWeight->Bold], 
    StyleBox["Description", "Text",
     FontWeight->Bold]},
   {"Unravel", "True", 
    RowBox[{
     StyleBox[
      RowBox[{
      "Specifies", " ", "if", " ", "an", " ", "Unravel", " ", "or", " ", 
       "Reravel", " ", "operation", " ", "should", " ", "be", " ", 
       "performed", ".", " ", "Unravel"}], "Text"], 
     StyleBox["\[Rule]", "Text"], 
     RowBox[{"False", " ", "implements", " ", "the", " ", "Reravel", " ", 
      RowBox[{"operation", "."}]}]}]}
  },
  GridBoxAlignment->{"Columns" -> {{Left}}},
  GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{True}}},
  GridBoxItemSize->{"Columns" -> {Automatic, Automatic, {
       Scaled[0.5]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
    "RowsIndexed" -> {}}]], "Text",
 CellChangeTimes->{{3.634325155121621*^9, 3.6343251805160007`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.634325188339939*^9, 3.634325189107485*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Unravel", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", "2"}], "]"}], "\[CircleTimes]", 
    RowBox[{"Array", "[", 
     RowBox[{"b", ",", "2"}], "]"}], "\[CircleTimes]", 
    RowBox[{"Array", "[", 
     RowBox[{"c", ",", "2"}], "]"}], "\[CircleTimes]", 
    RowBox[{"Array", "[", 
     RowBox[{"d", ",", "2"}], "]"}]}], "]"}], "-", 
  RowBox[{
   RowBox[{"Array", "[", 
    RowBox[{"a", ",", "2"}], "]"}], "\[CircleTimes]", 
   RowBox[{"Array", "[", 
    RowBox[{"c", ",", "2"}], "]"}], "\[CircleTimes]", 
   RowBox[{"Array", "[", 
    RowBox[{"b", ",", "2"}], "]"}], "\[CircleTimes]", 
   RowBox[{"Array", "[", 
    RowBox[{"d", ",", "2"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.634325192483304*^9, 3.634325253981756*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.634325216809389*^9, 3.634325223610045*^9}, 
   3.634325254327937*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reravel", "Subsection",
 CellChangeTimes->{{3.634311255040511*^9, 3.634311257357457*^9}}],

Cell[TextData[{
 StyleBox["Reravel[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",{", "Input"],
 StyleBox["d1,..,dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}]", "Input"],
 " applies the unravelling operation ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " where ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " may be a vector or matrix on ",
 StyleBox["2n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " subsystems where two subsystems have dimension ",
 StyleBox["dj", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " for each ",
 StyleBox["j", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ". It transforms an operator ",
 StyleBox["a1\[CircleTimes]b1\[CircleTimes]...\[CircleTimes]an\[CircleTimes]\
bn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " into an operator ",
 StyleBox["a1\[CircleTimes]....\[CircleTimes]an\[CircleTimes]b1\[CircleTimes].\
..\[CircleTimes]bn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 "\n\n",
 StyleBox["Reravel[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["d", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " applies the unravelling operation ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " where all subsystems are assumed to have dimension ",
 StyleBox["d", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ".\n\n",
 StyleBox["Reravel[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " assums ",
 StyleBox["d=2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" and returns ",
  FontWeight->"Plain"],
 StyleBox["Reravel[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",2]", "Input"],
 StyleBox[".",
  FontWeight->"Plain"]
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311262322356*^9, {3.634318626226563*^9, 3.63431862760165*^9}, {
   3.634324985130026*^9, 3.634324989572419*^9}, {3.634325084393806*^9, 
   3.634325130160615*^9}},
 CellTags->"Reravel::usage"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.6343296761149397`*^9, 3.63432967687464*^9}}],

Cell["Unravel and Reravel are inverse operations", "Text",
 CellChangeTimes->{{3.634325282085545*^9, 3.634325289503196*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Reravel", "[", 
   RowBox[{"Unravel", "[", 
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", "16"}], "]"}], "]"}], "]"}], "-", 
  RowBox[{"Array", "[", 
   RowBox[{"a", ",", "16"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.634325278842004*^9, 3.634325308672112*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.634325294995228*^9, 3.634325308928164*^9}}]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrix-Tensor Contractions", "Section",
 CellChangeTimes->{{3.634310848811734*^9, 3.634310852772456*^9}}],

Cell[CellGroupData[{

Cell["PartialTr", "Subsection",
 CellChangeTimes->{{3.634311147006694*^9, 3.6343111484129133`*^9}}],

Cell[TextData[{
 StyleBox["PartialTr[", "Input"],
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[", {", "Input"],
 StyleBox["d1,d2,...,dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["i1,..,ik", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}]", "Input"],
 " returns the matrix resulting from the partial trace over subsystems ",
 StyleBox["i1,..,ik", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " of the multipartite square matrix ",
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ", where subsystem ",
 StyleBox["j", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " has dimensions ",
 StyleBox["dj", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ".\n\n",
 StyleBox["PartialTr[", "Input"],
 StyleBox["vec", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[", {", "Input"],
 StyleBox["d1,d2,...,dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["i1,..,ik", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}]", "Input"],
 " returns the matrix resulting from the partial trace over subsystems ",
 StyleBox["i1,..,ik", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " of the multipartite square matrix ",
 StyleBox["mat=", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["Projector[", "Input"],
 StyleBox["vec", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " formed by the projector of the input vector or column vector ",
 StyleBox["vec", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".",
  FontWeight->"Plain",
  FontSlant->"Italic"]
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.6343111552573557`*^9, {3.63431863318824*^9, 3.634318634738823*^9}, {
   3.6343264445896177`*^9, 3.634326497416423*^9}, {3.634327259539918*^9, 
   3.6343273389977417`*^9}},
 CellTags->"PartialTr::usage"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.6343269364043503`*^9, 3.6343269386197968`*^9}}],

Cell["\<\
Partial Trace of a of middle subsystem of a tripartite matrix.\
\>", "Text",
 CellChangeTimes->{{3.63432694072626*^9, 3.634326945811885*^9}, {
  3.634327231666716*^9, 3.634327242194942*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PartialTr", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "8"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2", ",", "2"}], "}"}], ",", 
    RowBox[{"{", "2", "}"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634327097804036*^9, 3.6343271170751762`*^9}, {
  3.6343272452907677`*^9, 3.634327247948001*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "3"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "4"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "5"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "7"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "6"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "8"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "3"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "4"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "5"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "7"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "6"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "8"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"5", ",", "1"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"7", ",", "3"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"5", ",", "2"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"7", ",", "4"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"5", ",", "5"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"7", ",", "7"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"5", ",", "6"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"7", ",", "8"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"6", ",", "1"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"8", ",", "3"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"6", ",", "2"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"8", ",", "4"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"6", ",", "5"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"8", ",", "7"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"6", ",", "6"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"8", ",", "8"}], "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.63432711083384*^9, 3.6343271173308487`*^9}, 
   3.63432724830811*^9}]
}, Open  ]],

Cell["Partial trace over half of a maximally entangled Bell-state:", "Text",
 CellChangeTimes->{{3.6343272072641687`*^9, 3.634327219496735*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PartialTr", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "}"}], "/", 
     RowBox[{"Sqrt", "[", "2", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}], ",", 
    RowBox[{"{", "2", "}"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634327123495984*^9, 3.634327157641445*^9}, {
  3.634327193873852*^9, 3.634327205902581*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "2"], "0"},
     {"0", 
      FractionBox["1", "2"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634327131385153*^9, 3.634327158035264*^9}, {
  3.6343271921295643`*^9, 3.634327221602024*^9}}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["TensorPairContract", "Subsection",
 CellChangeTimes->{{3.634311158065545*^9, 3.634311160854965*^9}}],

Cell[TextData[{
 StyleBox["TensorPairContract[", "Input"],
 StyleBox["t1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["t2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",{{", "Input"],
 StyleBox["s11,s12", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["s21,s22", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},...}]", "Input"],
 " returns the tensor resulting from contracting index ",
 StyleBox["sj1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " of tensor ",
 StyleBox["t1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " with index ",
 StyleBox["sj2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " of tensor ",
 StyleBox["t2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ".\nIf the contract list is the empty list ",
 StyleBox["{}", "Input"],
 " it returs ",
 StyleBox["TensorProduct[", "Input"],
 StyleBox["t1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["t2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 "."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311165270151*^9, {3.634318635969058*^9, 3.634318638809119*^9}, {
   3.634326522592536*^9, 3.6343266101327047`*^9}},
 CellTags->"TensorPairContract::usage"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.634327350303303*^9, 3.6343273512006598`*^9}}],

Cell["Demonstrating matrix multiplication as a tensor contraction:", "Text",
 CellChangeTimes->{{3.63432735790985*^9, 3.6343274146759*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TensorPairContract", "[", 
     RowBox[{
      RowBox[{"Array", "[", 
       RowBox[{"a", ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "20"}], "}"}]}], "]"}], ",", 
      RowBox[{"Array", "[", 
       RowBox[{"b", ",", 
        RowBox[{"{", 
         RowBox[{"20", ",", "10"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1"}], "}"}], "}"}]}], "]"}], "-", 
    RowBox[{
     RowBox[{"Array", "[", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"10", ",", "20"}], "}"}]}], "]"}], ".", 
     RowBox[{"Array", "[", 
      RowBox[{"b", ",", 
       RowBox[{"{", 
        RowBox[{"20", ",", "10"}], "}"}]}], "]"}]}]}], "//", "Simplify"}], "//",
   "Norm"}]], "Input",
 CellChangeTimes->{{3.6343277801821527`*^9, 3.634327788881344*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.634327789276411*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["MatrixContract", "Subsection",
 CellChangeTimes->{{3.634311167256405*^9, 3.6343111691462803`*^9}}],

Cell[TextData[{
 StyleBox["MatrixContract[", "Input"],
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["dims", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",{{", "Input"],
 StyleBox["s11,s12", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["s21,s22", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},...}]", "Input"],
 " returns the contraction of mat in the pairs ",
 StyleBox["{", "Input"],
 StyleBox["sj1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[", ", "Input"],
 StyleBox["sj2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 " of slots by reshaping ",
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " to a tensor using ",
 StyleBox["tens", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["=MatrixToTensor[", "Input"],
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["dims", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 ", and then contracting according to ",
 StyleBox["TensorContract[tens,{{", "Input"],
 StyleBox["s11,s12", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["s21,s22", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},...}]", "Input"],
 " and flattening the result back to a matrix.\n\nSee ",
 StyleBox["MatrixToTensor", "Input"],
 " and ",
 StyleBox["TensorContract", "Input"],
 " for more details."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311173190103*^9, {3.634318640217225*^9, 3.634318641874872*^9}, {
   3.634326619676176*^9, 3.634326753159697*^9}},
 CellTags->"MatrixContract::usage"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.6343278045463457`*^9, 3.634327805345736*^9}}],

Cell["\<\
Contract the two right hand side indices of a matrix to return a vector:\
\>", "Text",
 CellChangeTimes->{{3.634327812775181*^9, 3.634327844151554*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MatrixContract", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634327845641173*^9, 3.634327870645131*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "4"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "4"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "1"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "4"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "1"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "4"}], "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634327865453793*^9, 3.634327871049242*^9}}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["MatrixPairContract", "Subsection",
 CellChangeTimes->{{3.6343111798567142`*^9, 3.63431118236517*^9}}],

Cell[TextData[{
 StyleBox["MatrixPairContract[{", "Input"],
 StyleBox["mat1,dims1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["mat2,dims2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{{", "Input"],
 StyleBox["s11,s12", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["s21,s22", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},...}] ", "Input"],
 "returns the matrix resulting from contracting index ",
 StyleBox["sj1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " of tensor ",
 StyleBox["t1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " with index ",
 StyleBox["sj2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " of tensor ",
 StyleBox["t2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " as per ",
 StyleBox["TensorPairContract ", "Input"],
 "where ",
 StyleBox["tj", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["= MatrixToTensor[", "Input"],
 StyleBox["matj,dimsj", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 ". If the contract list is the empty list ",
 StyleBox["{}", "Input"],
 " it yields ",
 StyleBox["CircleTimes[", "Input"],
 StyleBox["mat1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["mat2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 ".\n\nSee ",
 StyleBox["MatrixToTensor", "Input"],
 " and ",
 StyleBox["TensorPairContract", "Input"],
 " for more details."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{{3.634311185833832*^9, 3.6343111891488733`*^9}, {
  3.6343186440175037`*^9, 3.634318645753498*^9}, {3.6343267747352457`*^9, 
  3.634326906026476*^9}},
 CellTags->"MatrixPairContract::usage"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.63432787670648*^9, 3.6343278773698483`*^9}}],

Cell["Demonstrating matrix multiplication as a tensor contraction:", "Text",
 CellChangeTimes->{{3.63432735790985*^9, 3.6343274146759*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Array", "[", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"10", ",", "20"}], "}"}]}], "]"}], ".", 
     RowBox[{"Array", "[", 
      RowBox[{"b", ",", 
       RowBox[{"{", 
        RowBox[{"20", ",", "10"}], "}"}]}], "]"}]}], "-", 
    "\[IndentingNewLine]", 
    RowBox[{"MatrixPairContract", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Array", "[", 
         RowBox[{"a", ",", 
          RowBox[{"{", 
           RowBox[{"10", ",", "20"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "20"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Array", "[", 
         RowBox[{"b", ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "10"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"20", ",", "10"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1"}], "}"}], "}"}]}], "]"}]}], "//", "Simplify"}], 
  "//", "Norm"}]], "Input",
 CellChangeTimes->{{3.6343277801821527`*^9, 3.634327788881344*^9}, {
  3.634327919005637*^9, 3.6343279651308107`*^9}, {3.634328211330098*^9, 
  3.634328213169648*^9}, {3.634328422777266*^9, 3.634328430463314*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.634327789276411*^9, {3.634327947669262*^9, 3.634327974758628*^9}, {
   3.634328380981284*^9, 3.6343284308053207`*^9}}]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Operator Bases", "Section",
 CellChangeTimes->{{3.634310858014436*^9, 3.6343108658449507`*^9}}],

Cell[CellGroupData[{

Cell["Basis", "Subsection",
 CellChangeTimes->{{3.634311102400095*^9, 3.634311102860838*^9}}],

Cell[TextData[{
 StyleBox["Basis[", "Input"],
 StyleBox["basis", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns the multipartite matrix basis for a multipartite system with ",
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " identicle subsystems in terms of the subsystem basis ",
 StyleBox["basis", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[", which ",
  FontWeight->"Plain"],
 "may either be a list of vectors or matrices ",
 StyleBox["{", "Input"],
 StyleBox["b1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",...,", "Input"],
 StyleBox["bk", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 " or a string for named bases.\nSupported named bases are:\n\[Bullet]  ",
 StyleBox["\[CloseCurlyDoubleQuote]Pauli\[CloseCurlyDoubleQuote]", "Input"],
 " for the normalized Pauli basis ",
 StyleBox["PauliMatrix[", "Input"],
 StyleBox["j", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]/Sqrt[2]", "Input"],
 " with ",
 StyleBox["j", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["=0,1,2,3", "Input"],
 ".\n\[Bullet]  ",
 StyleBox["\[CloseCurlyDoubleQuote]PO\[CloseCurlyDoubleQuote]", "Input"],
 " for the product operator basis (unnormalized Pauli basis) ",
 StyleBox["PauliMatrix[", "Input"],
 StyleBox["j", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " with ",
 StyleBox["j", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["=0,1,2,3", "Input"],
 ".\n\n",
 StyleBox["Basis[", "Input"],
 StyleBox["basis", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns ",
 StyleBox["basis", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " if it is a list of operators, and returns the corresponding basis of \
operators if it is a named basis string. "
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{{3.6343111181549892`*^9, 3.634311128056398*^9}, {
  3.6343186498517714`*^9, 3.634318651337723*^9}, {3.6343285183123293`*^9, 
  3.634328761875929*^9}, {3.634328914570189*^9, 3.634328956619102*^9}},
 CellTags->"Basis::usage"],

Cell[CellGroupData[{

Cell["Example 1", "Subsubsection",
 CellChangeTimes->{{3.634328898352957*^9, 3.6343288990010233`*^9}, {
  3.634329065997589*^9, 3.6343290661115417`*^9}}],

Cell["Pauli Basis for a single system", "Text",
 CellChangeTimes->{{3.634328986724061*^9, 3.6343289911799097`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Basis", "[", "\"\<Pauli\>\"", "]"}]}]], "Input",
 CellChangeTimes->{{3.6343289016486063`*^9, 3.634328905113599*^9}, {
  3.634328963110499*^9, 3.634328993036989*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", 
         SqrtBox["2"]], "0"},
       {"0", 
        FractionBox["1", 
         SqrtBox["2"]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        FractionBox["1", 
         SqrtBox["2"]]},
       {
        FractionBox["1", 
         SqrtBox["2"]], "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        RowBox[{"-", 
         FractionBox["\[ImaginaryI]", 
          SqrtBox["2"]]}]},
       {
        FractionBox["\[ImaginaryI]", 
         SqrtBox["2"]], "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", 
         SqrtBox["2"]], "0"},
       {"0", 
        RowBox[{"-", 
         FractionBox["1", 
          SqrtBox["2"]]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.634328907094754*^9, {3.634328965051325*^9, 3.63432899345542*^9}}]
}, Open  ]],

Cell["Product Operator basis for 2 subsystems:", "Text",
 CellChangeTimes->{{3.634328995620619*^9, 3.634329002380846*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Basis", "[", 
   RowBox[{"\"\<PO\>\"", ",", "2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6343289698366127`*^9, 3.6343289700280657`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "1", "0", "0"},
       {"1", "0", "0", "0"},
       {"0", "0", "0", "1"},
       {"0", "0", "1", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        RowBox[{"-", "\[ImaginaryI]"}], "0", "0"},
       {"\[ImaginaryI]", "0", "0", "0"},
       {"0", "0", "0", 
        RowBox[{"-", "\[ImaginaryI]"}]},
       {"0", "0", "\[ImaginaryI]", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"-", "1"}], "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", 
        RowBox[{"-", "1"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"},
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "1"},
       {"0", "0", "1", "0"},
       {"0", "1", "0", "0"},
       {"1", "0", "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", 
        RowBox[{"-", "\[ImaginaryI]"}]},
       {"0", "0", "\[ImaginaryI]", "0"},
       {"0", 
        RowBox[{"-", "\[ImaginaryI]"}], "0", "0"},
       {"\[ImaginaryI]", "0", "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "1", "0"},
       {"0", "0", "0", 
        RowBox[{"-", "1"}]},
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"-", "1"}], "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", 
        RowBox[{"-", "\[ImaginaryI]"}], "0"},
       {"0", "0", "0", 
        RowBox[{"-", "\[ImaginaryI]"}]},
       {"\[ImaginaryI]", "0", "0", "0"},
       {"0", "\[ImaginaryI]", "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", 
        RowBox[{"-", "\[ImaginaryI]"}]},
       {"0", "0", 
        RowBox[{"-", "\[ImaginaryI]"}], "0"},
       {"0", "\[ImaginaryI]", "0", "0"},
       {"\[ImaginaryI]", "0", "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", 
        RowBox[{"-", "1"}]},
       {"0", "0", "1", "0"},
       {"0", "1", "0", "0"},
       {
        RowBox[{"-", "1"}], "0", "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", 
        RowBox[{"-", "\[ImaginaryI]"}], "0"},
       {"0", "0", "0", "\[ImaginaryI]"},
       {"\[ImaginaryI]", "0", "0", "0"},
       {"0", 
        RowBox[{"-", "\[ImaginaryI]"}], "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"-", "1"}], "0"},
       {"0", "0", "0", 
        RowBox[{"-", "1"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "1", "0", "0"},
       {"1", "0", "0", "0"},
       {"0", "0", "0", 
        RowBox[{"-", "1"}]},
       {"0", "0", 
        RowBox[{"-", "1"}], "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        RowBox[{"-", "\[ImaginaryI]"}], "0", "0"},
       {"\[ImaginaryI]", "0", "0", "0"},
       {"0", "0", "0", "\[ImaginaryI]"},
       {"0", "0", 
        RowBox[{"-", "\[ImaginaryI]"}], "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"-", "1"}], "0", "0"},
       {"0", "0", 
        RowBox[{"-", "1"}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{3.63432897034231*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Example 2", "Subsubsection",
 CellChangeTimes->{{3.634329068181617*^9, 3.634329069014865*^9}}],

Cell["\<\
Basis also works for vector bases. Consider the Plus basis for a qubit:\
\>", "Text",
 CellChangeTimes->{{3.634329071397273*^9, 3.63432909448773*^9}, {
  3.634329147978854*^9, 3.6343291484738483`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Basis", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], "/", 
      RowBox[{"Sqrt", "[", "2", "]"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "1"}]}], "}"}], "/", 
      RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.634329077679118*^9, 3.6343290862242937`*^9}, {
  3.634329116537286*^9, 3.634329159490135*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         FractionBox["1", 
          SqrtBox["2"]]},
        {
         FractionBox["1", 
          SqrtBox["2"]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         FractionBox["1", 
          SqrtBox["2"]]},
        {
         RowBox[{"-", 
          FractionBox["1", 
           SqrtBox["2"]]}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.634329086819631*^9, {3.634329120231735*^9, 3.6343291598411093`*^9}}]
}, Open  ]],

Cell["The plus basis for 2 qubits is given by", "Text",
 CellChangeTimes->{{3.634329097656314*^9, 3.634329103944086*^9}, {
  3.634329172169877*^9, 3.634329186489959*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Basis", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "/", 
       RowBox[{"Sqrt", "[", "2", "]"}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}]}], "}"}], "/", 
       RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}], ",", "2"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.634329105513557*^9, 3.634329136051854*^9}, {
  3.6343291682163687`*^9, 3.634329188563127*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         FractionBox["1", "2"]},
        {
         FractionBox["1", "2"]},
        {
         FractionBox["1", "2"]},
        {
         FractionBox["1", "2"]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         FractionBox["1", "2"]},
        {
         RowBox[{"-", 
          FractionBox["1", "2"]}]},
        {
         FractionBox["1", "2"]},
        {
         RowBox[{"-", 
          FractionBox["1", "2"]}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         FractionBox["1", "2"]},
        {
         FractionBox["1", "2"]},
        {
         RowBox[{"-", 
          FractionBox["1", "2"]}]},
        {
         RowBox[{"-", 
          FractionBox["1", "2"]}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         FractionBox["1", "2"]},
        {
         RowBox[{"-", 
          FractionBox["1", "2"]}]},
        {
         RowBox[{"-", 
          FractionBox["1", "2"]}]},
        {
         FractionBox["1", "2"]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{{3.634329112049776*^9, 3.634329136339696*^9}, {
  3.634329175804925*^9, 3.634329188918448*^9}}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["BasisLabels", "Subsection",
 CellChangeTimes->{{3.634311104007863*^9, 3.634311106675256*^9}}],

Cell[TextData[{
 StyleBox["BasisLabels[", "Input"],
 StyleBox["label", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns the basis labels for the multipartite matrix basis of a \
multipartite system with ",
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " identicle subsystems, in terms of the subsystem basis label ",
 StyleBox["label", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[", which m",
  FontWeight->"Plain"],
 "ay either be a list of strings ",
 StyleBox["{", "Input"],
 StyleBox["s1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",...,", "Input"],
 StyleBox["sk", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 " or a single string for named bases.\nSupported named bases are:\n\[Bullet] \
 ",
 StyleBox["\[OpenCurlyDoubleQuote]Pauli\[CloseCurlyDoubleQuote]", "Input"],
 " for the normalized Pauli basis.\n\[Bullet]  ",
 StyleBox["\[OpenCurlyDoubleQuote]PO\[CloseCurlyDoubleQuote]", "Input"],
 " for the product operator basis (unnormalized Pauli basis)."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311123104019*^9, {3.6343186537641172`*^9, 3.634318655298319*^9}, {
   3.634328796250102*^9, 3.6343288898478327`*^9}},
 CellTags->"BasisLabels::usage"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.634329011588978*^9, 3.634329012260766*^9}}],

Cell["Product operator basis for two qubits:", "Text",
 CellChangeTimes->{{3.634329031948084*^9, 3.6343290378524027`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BasisLabels", "[", 
  RowBox[{"\"\<PO\>\"", ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.6343290132772093`*^9, 3.634329029509178*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"I\"\>"}], ",", 
   RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"X\"\>"}], ",", 
   RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"Y\"\>"}], ",", 
   RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"Z\"\>"}], ",", 
   RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"I\"\>"}], ",", 
   RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"X\"\>"}], ",", 
   RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"Y\"\>"}], ",", 
   RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"Z\"\>"}], ",", 
   RowBox[{"\<\"Y\"\>", "\[CircleTimes]", "\<\"I\"\>"}], ",", 
   RowBox[{"\<\"Y\"\>", "\[CircleTimes]", "\<\"X\"\>"}], ",", 
   RowBox[{"\<\"Y\"\>", "\[CircleTimes]", "\<\"Y\"\>"}], ",", 
   RowBox[{"\<\"Y\"\>", "\[CircleTimes]", "\<\"Z\"\>"}], ",", 
   RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"I\"\>"}], ",", 
   RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"X\"\>"}], ",", 
   RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"Y\"\>"}], ",", 
   RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"Z\"\>"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6343290172845573`*^9, 3.634329029951603*^9}}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["ExpressInBasis", "Subsection",
 CellChangeTimes->{{3.634311108372843*^9, 3.63431111019592*^9}}],

Cell[TextData[{
 StyleBox["ExpressInBasis[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["opts", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["] ", "Input"],
 "expresses operator ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " in terms of basis elements for the basis specified in options ",
 StyleBox["opts", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ".\n\n",
 StyleBox["Options",
  FontWeight->"Bold",
  FontSlant->"Italic",
  FontColor->GrayLevel[0.5]],
 "\n\[Bullet]",
 StyleBox[" Basis\[Rule]", "Input"],
 StyleBox["basis ", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 "specifies the basis to express ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " in. The default basis value is ",
 StyleBox["\[CloseCurlyDoubleQuote]PO\[CloseCurlyDoubleQuote]", "Input"],
 " (see ",
 StyleBox["Basis", "Input"],
 " for more details).\n\[Bullet]",
 StyleBox[" BasisLabels\[Rule]", "Input"],
 StyleBox["labels", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " specifies whether to display the basis labels along side the basis element \
coefficients. The default value is ",
 StyleBox["False", "Input"],
 ". ",
 StyleBox["labels", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" may b",
  FontWeight->"Plain"],
 StyleBox["e",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" ",
  FontSlant->"Italic"],
 "a list of string labels, or the value ",
 StyleBox["True", "Input"],
 " to use the default labels for a named basis (see ",
 StyleBox["BasisLabels", "Input"],
 " for more details)."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311133927567*^9, {3.634318657915893*^9, 3.6343186594910316`*^9}, {
   3.634329217923348*^9, 3.634329487725719*^9}},
 CellTags->"ExpressInBasis::usage"],

Cell[CellGroupData[{

Cell["Options", "Subsubsection",
 CellChangeTimes->{{3.6343115904944897`*^9, 3.634311591135709*^9}}],

Cell[BoxData[GridBox[{
   {
    StyleBox["Option", "Text",
     FontWeight->Bold], 
    StyleBox[
     RowBox[{"Default", " ", "Value"}], "Text",
     FontWeight->Bold], 
    StyleBox["Description", "Text",
     FontWeight->Bold]},
   {"Basis", "\"\<PO\>\"", 
    StyleBox[
     RowBox[{
     "Specifies", " ", "the", " ", "basis", " ", "to", " ", "express", " ", 
      "an", " ", "operator", " ", "in", " ", "terms", " ", 
      RowBox[{"of", ".", " ", "It"}], " ", "may", " ", "be", " ", "a", " ", 
      "named", " ", "basis", " ", "string", " ", "or", " ", "a", " ", "list", 
      " ", "of", " ", "basis", " ", 
      RowBox[{"elements", "."}]}], "Text"]},
   {"BasisLabels", "False", 
    StyleBox[
     RowBox[{
      RowBox[{
      "Specifies", " ", "whether", " ", "to", " ", "display", " ", "the", " ",
        "basis", " ", "labels", " ", "in", " ", "the", " ", 
       RowBox[{"decomposition", ".", " ", "It"}], " ", "may", " ", "be", " ", 
       "False"}], ",", " ", "True", ",", " ", 
      RowBox[{
      "or", " ", "a", " ", "list", " ", "of", " ", "basis", " ", "label", " ", 
       RowBox[{"strings", "."}]}]}], "Text"]}
  },
  GridBoxAlignment->{"Columns" -> {{Left}}},
  GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{True}}},
  GridBoxItemSize->{"Columns" -> {Automatic, Automatic, {
       Scaled[0.5]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
    "RowsIndexed" -> {}}]], "Text",
 CellChangeTimes->{
  3.634329345109686*^9, {3.634329498265435*^9, 3.634329555001143*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.634329046926429*^9, 3.6343290476219788`*^9}}],

Cell["Express a bipartite matrix in the PO Basis", "Text",
 CellChangeTimes->{{3.634329574537704*^9, 3.634329583256496*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpressInBasis", "[", 
   RowBox[{"Array", "[", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "]"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634329558139332*^9, 3.634329585986315*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "1"}], "]"}], "+", 
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "2"}], "]"}], "+", 
        RowBox[{"a", "[", 
         RowBox[{"3", ",", "3"}], "]"}], "+", 
        RowBox[{"a", "[", 
         RowBox[{"4", ",", "4"}], "]"}]}]},
      {
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "2"}], "]"}], "+", 
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "1"}], "]"}], "+", 
        RowBox[{"a", "[", 
         RowBox[{"3", ",", "4"}], "]"}], "+", 
        RowBox[{"a", "[", 
         RowBox[{"4", ",", "3"}], "]"}]}]},
      {
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "2"}], "]"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "1"}], "]"}]}], "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "4"}], "]"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "3"}], "]"}]}]}]},
      {
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "1"}], "]"}], "-", 
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "2"}], "]"}], "+", 
        RowBox[{"a", "[", 
         RowBox[{"3", ",", "3"}], "]"}], "-", 
        RowBox[{"a", "[", 
         RowBox[{"4", ",", "4"}], "]"}]}]},
      {
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "3"}], "]"}], "+", 
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "4"}], "]"}], "+", 
        RowBox[{"a", "[", 
         RowBox[{"3", ",", "1"}], "]"}], "+", 
        RowBox[{"a", "[", 
         RowBox[{"4", ",", "2"}], "]"}]}]},
      {
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "4"}], "]"}], "+", 
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "3"}], "]"}], "+", 
        RowBox[{"a", "[", 
         RowBox[{"3", ",", "2"}], "]"}], "+", 
        RowBox[{"a", "[", 
         RowBox[{"4", ",", "1"}], "]"}]}]},
      {
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "4"}], "]"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "3"}], "]"}]}], "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "2"}], "]"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "1"}], "]"}]}]}]},
      {
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "3"}], "]"}], "-", 
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "4"}], "]"}], "+", 
        RowBox[{"a", "[", 
         RowBox[{"3", ",", "1"}], "]"}], "-", 
        RowBox[{"a", "[", 
         RowBox[{"4", ",", "2"}], "]"}]}]},
      {
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "3"}], "]"}]}], "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "4"}], "]"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "1"}], "]"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "2"}], "]"}]}]}]},
      {
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "4"}], "]"}]}], "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "3"}], "]"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "2"}], "]"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "1"}], "]"}]}]}]},
      {
       RowBox[{
        RowBox[{"-", 
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "4"}], "]"}]}], "+", 
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "3"}], "]"}], "+", 
        RowBox[{"a", "[", 
         RowBox[{"3", ",", "2"}], "]"}], "-", 
        RowBox[{"a", "[", 
         RowBox[{"4", ",", "1"}], "]"}]}]},
      {
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "3"}], "]"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "4"}], "]"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "1"}], "]"}]}], "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "2"}], "]"}]}]}]},
      {
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "1"}], "]"}], "+", 
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "2"}], "]"}], "-", 
        RowBox[{"a", "[", 
         RowBox[{"3", ",", "3"}], "]"}], "-", 
        RowBox[{"a", "[", 
         RowBox[{"4", ",", "4"}], "]"}]}]},
      {
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "2"}], "]"}], "+", 
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "1"}], "]"}], "-", 
        RowBox[{"a", "[", 
         RowBox[{"3", ",", "4"}], "]"}], "-", 
        RowBox[{"a", "[", 
         RowBox[{"4", ",", "3"}], "]"}]}]},
      {
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "2"}], "]"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "1"}], "]"}]}], "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "4"}], "]"}]}], "+", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "3"}], "]"}]}]}]},
      {
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "1"}], "]"}], "-", 
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "2"}], "]"}], "-", 
        RowBox[{"a", "[", 
         RowBox[{"3", ",", "3"}], "]"}], "+", 
        RowBox[{"a", "[", 
         RowBox[{"4", ",", "4"}], "]"}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634329566204915*^9, 3.634329586188072*^9}}]
}, Open  ]],

Cell["The same matrix with basis labels", "Text",
 CellChangeTimes->{{3.6343295926347733`*^9, 3.634329596259069*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpressInBasis", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"BasisLabels", "\[Rule]", "True"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6343295993081007`*^9, 3.634329604365075*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"I\"\>"}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "3"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "4"}], "]"}]}]},
     {
      RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"X\"\>"}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "4"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "3"}], "]"}]}]},
     {
      RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"Y\"\>"}], 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "2"}], "]"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "1"}], "]"}]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"a", "[", 
         RowBox[{"3", ",", "4"}], "]"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"a", "[", 
         RowBox[{"4", ",", "3"}], "]"}]}]}]},
     {
      RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"Z\"\>"}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], "-", 
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "3"}], "]"}], "-", 
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "4"}], "]"}]}]},
     {
      RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"I\"\>"}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "3"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "4"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "1"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "2"}], "]"}]}]},
     {
      RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"X\"\>"}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "4"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "3"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "2"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "1"}], "]"}]}]},
     {
      RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"Y\"\>"}], 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "4"}], "]"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"a", "[", 
         RowBox[{"3", ",", "2"}], "]"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"a", "[", 
         RowBox[{"4", ",", "1"}], "]"}]}]}]},
     {
      RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"Z\"\>"}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "3"}], "]"}], "-", 
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "4"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "1"}], "]"}], "-", 
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "2"}], "]"}]}]},
     {
      RowBox[{"\<\"Y\"\>", "\[CircleTimes]", "\<\"I\"\>"}], 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "3"}], "]"}]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "4"}], "]"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"a", "[", 
         RowBox[{"3", ",", "1"}], "]"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"a", "[", 
         RowBox[{"4", ",", "2"}], "]"}]}]}]},
     {
      RowBox[{"\<\"Y\"\>", "\[CircleTimes]", "\<\"X\"\>"}], 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "4"}], "]"}]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"a", "[", 
         RowBox[{"3", ",", "2"}], "]"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"a", "[", 
         RowBox[{"4", ",", "1"}], "]"}]}]}]},
     {
      RowBox[{"\<\"Y\"\>", "\[CircleTimes]", "\<\"Y\"\>"}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "4"}], "]"}]}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "3"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "2"}], "]"}], "-", 
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "1"}], "]"}]}]},
     {
      RowBox[{"\<\"Y\"\>", "\[CircleTimes]", "\<\"Z\"\>"}], 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "3"}], "]"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "4"}], "]"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"a", "[", 
         RowBox[{"3", ",", "1"}], "]"}]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"a", "[", 
         RowBox[{"4", ",", "2"}], "]"}]}]}]},
     {
      RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"I\"\>"}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], "-", 
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "3"}], "]"}], "-", 
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "4"}], "]"}]}]},
     {
      RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"X\"\>"}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], "-", 
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "4"}], "]"}], "-", 
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "3"}], "]"}]}]},
     {
      RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"Y\"\>"}], 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "2"}], "]"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "1"}], "]"}]}], "-", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"a", "[", 
         RowBox[{"3", ",", "4"}], "]"}]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"a", "[", 
         RowBox[{"4", ",", "3"}], "]"}]}]}]},
     {
      RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"Z\"\>"}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], "-", 
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], "-", 
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "3"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "4"}], "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.634329604901819*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vectorization", "Section",
 CellChangeTimes->{{3.634310868499579*^9, 3.634310869782322*^9}}],

Cell[CellGroupData[{

Cell["Vec", "Subsection",
 CellChangeTimes->{{3.634310922061626*^9, 3.634310922387836*^9}, {
  3.634310955192596*^9, 3.6343109717760973`*^9}}],

Cell[TextData[{
 StyleBox["Vec[", "Input"],
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["opts", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns a column vector formed by vectorizing a matrix ",
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " using the vectorization convention specified by the options ",
 StyleBox["opts", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ".\n\n",
 StyleBox["Options",
  FontWeight->"Bold",
  FontSlant->"Italic",
  FontColor->GrayLevel[0.5]],
 "\n\[Bullet]",
 StyleBox[" Basis\[Rule]", "Input"],
 StyleBox["basis", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " specifies the vectorization basis convention to be used. It may be a \
string for named basies, or a list of basis operators. Allowed named bases \
are ",
 StyleBox["\[OpenCurlyDoubleQuote]Col\[CloseCurlyDoubleQuote]", "Input"],
 ", ",
 StyleBox["\[OpenCurlyDoubleQuote]Row\[CloseCurlyDoubleQuote]", "Input"],
 ", ",
 StyleBox["\[OpenCurlyDoubleQuote]Pauli\[CloseCurlyDoubleQuote]", "Input"],
 " and ",
 StyleBox["\[OpenCurlyDoubleQuote]PO\[CloseCurlyDoubleQuote]", "Input"],
 ". The default value is ",
 StyleBox["\[OpenCurlyDoubleQuote]Col\[CloseCurlyDoubleQuote]", "Input"],
 " and corresponds to stacking the columns of ",
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " together to form a vector."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{{3.634311052959324*^9, 3.634311056263317*^9}, {
  3.634329793889833*^9, 3.634329971841034*^9}, {3.6343300917011843`*^9, 
  3.634330101373704*^9}},
 CellTags->"Vec::usage"],

Cell[CellGroupData[{

Cell["Options", "Subsubsection",
 CellChangeTimes->{{3.634311058006653*^9, 3.634311058580744*^9}}],

Cell[BoxData[GridBox[{
   {
    StyleBox["Option", "Text",
     FontWeight->Bold], 
    StyleBox[
     RowBox[{"Default", " ", "Value"}], "Text",
     FontWeight->Bold], 
    StyleBox["Description", "Text",
     FontWeight->Bold]},
   {"Basis", "\"\<Col\>\"", 
    StyleBox[
     RowBox[{
      RowBox[{
      "Specifies", " ", "the", " ", "basis", " ", "to", " ", "be", " ", 
       "used", " ", "for", " ", 
       RowBox[{"vectorization", ".", " ", "Supposed"}], " ", "named", " ", 
       "bases", " ", "are", " ", 
       "\!\(\*\"\\\"\"\)\!\(\*\"Col\"\)\!\(\*\"\\\"\"\)"}], ",", " ", 
      "\!\(\*\"\\\"\"\)\!\(\*\"Row\"\)\!\(\*\"\\\"\"\)", ",", " ", 
      RowBox[{
      "\!\(\*\"\\\"\"\)\!\(\*\"Pauli\"\)\!\(\*\"\\\"\"\)", " ", "and", " ", 
       RowBox[{
       "\!\(\*\"\\\"\"\)\!\(\*\"PO\"\)\!\(\*\"\\\"\"\)", ".", " ", "May"}], 
       " ", "also", " ", "be", " ", "a", " ", "list", " ", "of", " ", "basis",
        " ", "operators", " ", "for", " ", "other", " ", 
       RowBox[{"bases", "."}]}]}], "Text"]}
  },
  GridBoxAlignment->{"Columns" -> {{Left}}},
  GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{True}}},
  GridBoxItemSize->{"Columns" -> {Automatic, Automatic, {
       Scaled[0.5]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
    "RowsIndexed" -> {}}]], "Text",
 CellChangeTimes->{{3.634329985002905*^9, 3.634330025008963*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.634311059806551*^9, 3.6343110619107723`*^9}, {
  3.634342578347068*^9, 3.634342578508274*^9}}],

Cell["Vectorizing a matrix in the default col-stacking convention:", "Text",
 CellChangeTimes->{{3.634330185240637*^9, 3.634330197625986*^9}, 
   3.634342593571574*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Vec", "[", 
   RowBox[{"Array", "[", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634330160899394*^9, 3.634330170452004*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"a", "[", 
       RowBox[{"1", ",", "1"}], "]"}]},
     {
      RowBox[{"a", "[", 
       RowBox[{"2", ",", "1"}], "]"}]},
     {
      RowBox[{"a", "[", 
       RowBox[{"1", ",", "2"}], "]"}]},
     {
      RowBox[{"a", "[", 
       RowBox[{"2", ",", "2"}], "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6343301676048203`*^9, 3.6343301708074427`*^9}}]
}, Open  ]],

Cell["The same matrix vectorized in row-stacking convention:", "Text",
 CellChangeTimes->{{3.634342475320836*^9, 3.6343424899392853`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Vec", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}]}], "]"}], ",", 
    RowBox[{"Basis", "\[Rule]", "\"\<Row\>\""}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634342494253759*^9, 3.6343424970770283`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"a", "[", 
       RowBox[{"1", ",", "1"}], "]"}]},
     {
      RowBox[{"a", "[", 
       RowBox[{"1", ",", "2"}], "]"}]},
     {
      RowBox[{"a", "[", 
       RowBox[{"2", ",", "1"}], "]"}]},
     {
      RowBox[{"a", "[", 
       RowBox[{"2", ",", "2"}], "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.634342497680213*^9}]
}, Open  ]],

Cell["... and finally, vectorized in the Pauli Basis:", "Text",
 CellChangeTimes->{{3.634330173993432*^9, 3.6343302055530167`*^9}, {
  3.634342503322674*^9, 3.6343425191562347`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Vec", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}]}], "]"}], ",", 
    RowBox[{"Basis", "\[Rule]", "\"\<Pauli\>\""}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634330177594534*^9, 3.634330180769084*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox[
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "1"}], "]"}], 
        SqrtBox["2"]], "+", 
       FractionBox[
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "2"}], "]"}], 
        SqrtBox["2"]]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "2"}], "]"}], 
        SqrtBox["2"]], "+", 
       FractionBox[
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "1"}], "]"}], 
        SqrtBox["2"]]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "2"}], "]"}]}], 
        SqrtBox["2"]], "-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "1"}], "]"}]}], 
        SqrtBox["2"]]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "1"}], "]"}], 
        SqrtBox["2"]], "-", 
       FractionBox[
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "2"}], "]"}], 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.634330181117577*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Devec", "Subsection",
 CellChangeTimes->{{3.634310927945176*^9, 3.63431092862017*^9}, {
  3.634310959534721*^9, 3.6343109606146193`*^9}, {3.634311002194971*^9, 
  3.634311002284896*^9}}],

Cell[TextData[{
 StyleBox["Devec[", "Input"],
 StyleBox["vecMat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["opts", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns the matrix formed by de-vectorizing a vectorized matrix ",
 StyleBox["mecMat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " using the vectorization convention specified by the options ",
 StyleBox["opts", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ".\n\n",
 StyleBox["Options",
  FontWeight->"Bold",
  FontSlant->"Italic",
  FontColor->GrayLevel[0.5]],
 "\n\[Bullet]",
 StyleBox[" Basis\[Rule]", "Input"],
 StyleBox["basis", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " specifies the vectorization basis convention to be used. It may be a \
string for named basies, or a list of basis operators. Allowed named bases \
are ",
 StyleBox["\[OpenCurlyDoubleQuote]Col\[CloseCurlyDoubleQuote]", "Input"],
 ", ",
 StyleBox["\[OpenCurlyDoubleQuote]Row\[CloseCurlyDoubleQuote]", "Input"],
 ", ",
 StyleBox["\[OpenCurlyDoubleQuote]Pauli\[CloseCurlyDoubleQuote]", "Input"],
 " and ",
 StyleBox["\[OpenCurlyDoubleQuote]PO\[CloseCurlyDoubleQuote]", "Input"],
 ". The default value is ",
 StyleBox["\[OpenCurlyDoubleQuote]Col\[CloseCurlyDoubleQuote]", "Input"],
 " and corresponds to stacking the columns of ",
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " together to form a vector."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{{3.634311041530568*^9, 3.6343110439895277`*^9}, {
  3.634330039973859*^9, 3.634330118598291*^9}},
 CellTags->"Devec::usage"],

Cell[CellGroupData[{

Cell["Options", "Subsubsection",
 CellChangeTimes->{{3.634311058006653*^9, 3.634311058580744*^9}}],

Cell["The options are the same as for Vec.", "Text",
 CellChangeTimes->{{3.634330145936471*^9, 3.6343301567044983`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.634311059806551*^9, 3.6343110619107723`*^9}, {
  3.634342575756796*^9, 3.634342576043347*^9}}],

Cell["\<\
De-vectorizing a vector in the default col-stacking convention:\
\>", "Text",
 CellChangeTimes->{{3.634330185240637*^9, 3.634330197625986*^9}, {
  3.634342583275296*^9, 3.634342590091613*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Devec", "[", 
   RowBox[{"Array", "[", 
    RowBox[{"a", ",", "4"}], "]"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634330160899394*^9, 3.634330170452004*^9}, {
  3.6343425973820744`*^9, 3.634342601050905*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"a", "[", "1", "]"}], 
      RowBox[{"a", "[", "3", "]"}]},
     {
      RowBox[{"a", "[", "2", "]"}], 
      RowBox[{"a", "[", "4", "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6343301676048203`*^9, 3.6343301708074427`*^9}, 
   3.634342601525776*^9}]
}, Open  ]],

Cell["The same matrix vectorized in row-stacking convention:", "Text",
 CellChangeTimes->{{3.634342475320836*^9, 3.6343424899392853`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Devec", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", "4"}], "]"}], ",", 
    RowBox[{"Basis", "\[Rule]", "\"\<Row\>\""}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634342494253759*^9, 3.6343424970770283`*^9}, {
  3.634342606350422*^9, 3.6343426071251373`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"a", "[", "1", "]"}], 
      RowBox[{"a", "[", "2", "]"}]},
     {
      RowBox[{"a", "[", "3", "]"}], 
      RowBox[{"a", "[", "4", "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.634342497680213*^9, 3.634342607874937*^9}]
}, Open  ]],

Cell["... and finally, vectorized in the Pauli Basis:", "Text",
 CellChangeTimes->{{3.634330173993432*^9, 3.6343302055530167`*^9}, {
  3.634342503322674*^9, 3.6343425191562347`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Devec", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", "4"}], "]"}], ",", 
    RowBox[{"Basis", "\[Rule]", "\"\<Pauli\>\""}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634330177594534*^9, 3.634330180769084*^9}, {
  3.634342611574954*^9, 3.634342614277372*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox[
        RowBox[{"a", "[", "1", "]"}], 
        SqrtBox["2"]], "+", 
       FractionBox[
        RowBox[{"a", "[", "4", "]"}], 
        SqrtBox["2"]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"a", "[", "2", "]"}], 
        SqrtBox["2"]], "-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", "3", "]"}]}], 
        SqrtBox["2"]]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{"a", "[", "2", "]"}], 
        SqrtBox["2"]], "+", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", "3", "]"}]}], 
        SqrtBox["2"]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"a", "[", "1", "]"}], 
        SqrtBox["2"]], "-", 
       FractionBox[
        RowBox[{"a", "[", "4", "]"}], 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.634330181117577*^9, 3.6343426147933693`*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["ProductIdentity", "Subsection",
 CellChangeTimes->{{3.634310931285899*^9, 3.634310935696518*^9}, 
   3.63431100098005*^9}],

Cell[TextData[{
 StyleBox["ProductIdentity[", "Input"],
 StyleBox["A,C,opts", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns a matrix ",
 StyleBox["M", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " such that ",
 StyleBox["M", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".Vec[", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]=Vec[", "Input"],
 StyleBox["A.B.C", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 "for matrices ",
 StyleBox["A,B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " and ",
 StyleBox["C ", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 "using the vectorization convention specified by the options ",
 StyleBox["opts", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ".\n\n",
 StyleBox["Options",
  FontWeight->"Bold",
  FontSlant->"Italic",
  FontColor->GrayLevel[0.5]],
 "\n\[Bullet]",
 StyleBox[" Basis\[Rule]", "Input"],
 StyleBox["basis", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " specifies the vectorization basis convention to be used. It may be a \
string for named basies, or a list of basis operators. Allowed named bases \
are ",
 StyleBox["\[OpenCurlyDoubleQuote]Col\[CloseCurlyDoubleQuote]", "Input"],
 ", ",
 StyleBox["\[OpenCurlyDoubleQuote]Row\[CloseCurlyDoubleQuote]", "Input"],
 ", ",
 StyleBox["\[OpenCurlyDoubleQuote]Pauli\[CloseCurlyDoubleQuote]", "Input"],
 " and ",
 StyleBox["\[OpenCurlyDoubleQuote]PO\[CloseCurlyDoubleQuote]", "Input"],
 ". The default value is ",
 StyleBox["\[OpenCurlyDoubleQuote]Col\[CloseCurlyDoubleQuote]", "Input"],
 " and corresponds to stacking the columns of ",
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " together to form a vector."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{{3.6343110346563396`*^9, 3.6343110456207457`*^9}, {
  3.6343426575341387`*^9, 3.634342658303225*^9}, {3.63434269073072*^9, 
  3.634342700869084*^9}},
 CellTags->"ProductIdentity::usage"],

Cell[CellGroupData[{

Cell["Options", "Subsubsection",
 CellChangeTimes->{{3.634311058006653*^9, 3.634311058580744*^9}}],

Cell["The options are the same as for Vec", "Text",
 CellChangeTimes->{3.634342715886712*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.634311059806551*^9, 3.6343110619107723`*^9}, {
  3.634342853052717*^9, 3.63434285322226*^9}}],

Cell["Check this satisfies the definition", "Text",
 CellChangeTimes->{{3.634342751939019*^9, 3.634342756322907*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ProductIdentity", "[", 
    RowBox[{
     RowBox[{"Array", "[", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], "]"}], ",", 
     RowBox[{"Array", "[", 
      RowBox[{"c", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "]"}], ".", 
   RowBox[{"Vec", "[", 
    RowBox[{"Array", "[", 
     RowBox[{"b", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "]"}]}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "-", 
   RowBox[{"Vec", "[", 
    RowBox[{
     RowBox[{"Array", "[", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], "]"}], ".", 
     RowBox[{"Array", "[", 
      RowBox[{"b", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], "]"}], ".", 
     RowBox[{"Array", "[", 
      RowBox[{"c", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.6343427228192253`*^9, 3.634342849022607*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"1", ",", "1"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "2"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"2", ",", "1"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"1", ",", "1"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"1", ",", "2"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"2", ",", "1"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "2"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"2", ",", "2"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"2", ",", "1"}], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "1"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"1", ",", "1"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "2"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"2", ",", "1"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"1", ",", "1"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "1"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"1", ",", "2"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"2", ",", "1"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "2"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"2", ",", "2"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"2", ",", "1"}], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"1", ",", "2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "2"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"2", ",", "1"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"1", ",", "2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"1", ",", "2"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"2", ",", "2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "2"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"2", ",", "2"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"2", ",", "2"}], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "1"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"1", ",", "2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "2"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"2", ",", "1"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"1", ",", "2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "1"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"1", ",", "2"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"2", ",", "2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "2"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"2", ",", "2"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"2", ",", "2"}], "]"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6343427370742683`*^9, 3.634342849570039*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6343427370742683`*^9, 3.634342849583488*^9}}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Changing Vec Basis", "Subsection",
 CellChangeTimes->{{3.6343109399484663`*^9, 3.6343109519416733`*^9}}],

Cell[TextData[{
 StyleBox["BasisMatrix[\[OpenCurlyDoubleQuote]Col\[CloseCurlyDoubleQuote]\
\[Rule]", "Input"],
 StyleBox["basis", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[", ", "Input"],
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["] ", "Input"],
 "returns the change of basis unitary matrix for transforming an ",
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 "-partite matrix vectorized in ",
 StyleBox["\[OpenCurlyDoubleQuote]Col\[CloseCurlyDoubleQuote]", "Input"],
 " convention to the ",
 StyleBox["basis", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " vectorization convention. basis may be ",
 StyleBox["\[OpenCurlyDoubleQuote]Pauli\[CloseCurlyDoubleQuote]", "Input"],
 ", ",
 StyleBox["\[OpenCurlyDoubleQuote]PO\[CloseCurlyDoubleQuote]", "Input"],
 ", or a list of basis matrices ",
 StyleBox["{", "Input"],
 StyleBox["b1,...,bk", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 ". If ",
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" is not specified then it is assumed to be 1.",
  FontWeight->"Plain"],
 " \n",
 StyleBox["BasisMatrix[", "Input"],
 StyleBox["basis", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["\[Rule]\[CloseCurlyDoubleQuote]Col\[CloseCurlyDoubleQuote], ", 
  "Input"],
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns the inverse basis transformation matrix. \n",
 StyleBox["\nBasisMatrix[\[OpenCurlyDoubleQuote]Col\[CloseCurlyDoubleQuote]\
\[Rule]\[CloseCurlyDoubleQuote]Row\[CloseCurlyDoubleQuote],{", "Input"],
 StyleBox["dL", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["dR", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}] ", "Input"],
 "returns the change of basis unitary matrix for transforming a ",
 StyleBox["{", "Input"],
 StyleBox["dL", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["dR", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 " dimensional matrix vectorized in ",
 StyleBox["\[OpenCurlyDoubleQuote]Col\[CloseCurlyDoubleQuote]", "Input"],
 " convention to ",
 StyleBox["\[OpenCurlyDoubleQuote]Row\[CloseCurlyDoubleQuote]", "Input"],
 " convention.\n",
 StyleBox["BasisMatrix[\[OpenCurlyDoubleQuote]Row\[CloseCurlyDoubleQuote]\
\[Rule]\[CloseCurlyDoubleQuote]Col\[CloseCurlyDoubleQuote],{", "Input"],
 StyleBox["dL", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["dR", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}]", "Input"],
 " returns the inverse transformation matrix."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311025702045*^9, {3.634342886453363*^9, 3.634342907599017*^9}, {
   3.6343442189163322`*^9, 3.6343442211062202`*^9}, {3.6343442615011044`*^9, 
   3.634344335922759*^9}, {3.634344384498783*^9, 3.634344464131016*^9}, {
   3.63434456180206*^9, 3.634344598138336*^9}, {3.6343446368820143`*^9, 
   3.634344774418923*^9}, {3.634344811140554*^9, 3.6343449489110613`*^9}, {
   3.634345022440645*^9, 3.6343450441723833`*^9}, 3.634345091797738*^9, {
   3.634345240846065*^9, 3.634345450190198*^9}},
 CellTags->"BasisMatrix::usage"],

Cell[TextData[{
 StyleBox["BasisTransformation[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[", ", "Input"],
 StyleBox["basis1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["\[Rule]", "Input"],
 StyleBox["basis2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["] ", "Input"],
 "transforms an operator in vectorization ",
 StyleBox["basis1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " to an operator in vectorization ",
 StyleBox["basis2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ". ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " may be a matrix which acts on vectorized matrices, or a vectorized matrix. \
Allowed bases are ",
 StyleBox["\[OpenCurlyDoubleQuote]Col\[CloseCurlyDoubleQuote],\
\[OpenCurlyDoubleQuote]Row\[CloseCurlyDoubleQuote],\[OpenCurlyDoubleQuote]\
Pauli\[CloseCurlyDoubleQuote],\[OpenCurlyDoubleQuote]PO\
\[CloseCurlyDoubleQuote]", "Input"],
 " or a basis specified by a list of basis matrices ",
 StyleBox["{", "Input"],
 StyleBox["b1,...,bk", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 "."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311013135188*^9, {3.634343515726198*^9, 3.63434351646231*^9}, {
   3.634343551183639*^9, 3.634343634962907*^9}, {3.634344189249134*^9, 
   3.6343441908562603`*^9}},
 CellTags->"BasisTransformation::usage"],

Cell[CellGroupData[{

Cell["Example 1", "Subsubsection",
 CellChangeTimes->{{3.6343438784149303`*^9, 3.63434387995182*^9}}],

Cell["\<\
Change of basis matrix for changing from \[OpenCurlyDoubleQuote]Col\
\[CloseCurlyDoubleQuote] vectorization to \[OpenCurlyDoubleQuote]Pauli\
\[CloseCurlyDoubleQuote] vectorization:\
\>", "Text",
 CellChangeTimes->{{3.6343440867532587`*^9, 3.634344103657028*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BasisMatrix", "[", 
   RowBox[{"\"\<Col\>\"", "\[Rule]", "\"\<Pauli\>\""}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634343909872642*^9, 3.634343924769537*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       SqrtBox["2"]], "0", "0", 
      FractionBox["1", 
       SqrtBox["2"]]},
     {"0", 
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SqrtBox["2"]], "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        SqrtBox["2"]]}], 
      FractionBox["\[ImaginaryI]", 
       SqrtBox["2"]], "0"},
     {
      FractionBox["1", 
       SqrtBox["2"]], "0", "0", 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634343919673689*^9, 3.634343925361484*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BasisMatrix", "[", 
   RowBox[{"\"\<Col\>\"", "\[Rule]", "\"\<Pauli\>\""}], "]"}], ".", 
  RowBox[{"Vec", "[", 
   RowBox[{"TP", "[", "I", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.634343929412682*^9, 3.6343439323039627`*^9}, {
  3.634344055055409*^9, 3.634344055429455*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    SqrtBox["2"], "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.634343932724279*^9, 3.6343440560172377`*^9}]
}, Open  ]],

Cell["For changing a system of 2-qubits to Pauli vectorization", "Text",
 CellChangeTimes->{{3.6343439933172817`*^9, 3.63434401866851*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BasisMatrix", "[", 
   RowBox[{
    RowBox[{"\"\<Col\>\"", "\[Rule]", "\"\<Pauli\>\""}], ",", "2"}], "]"}], "//",
   "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634343970815525*^9, 3.634343970959241*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "2"], "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", "0", "0", "0", 
      FractionBox["1", "2"]},
     {"0", 
      FractionBox["1", "2"], "0", "0", 
      FractionBox["1", "2"], "0", "0", "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", "0", 
      FractionBox["1", "2"], "0"},
     {"0", "0", 
      FractionBox["1", "2"], "0", "0", "0", "0", 
      FractionBox["1", "2"], 
      FractionBox["1", "2"], "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", "0"},
     {"0", "0", "0", 
      FractionBox["1", "2"], "0", "0", 
      FractionBox["1", "2"], "0", "0", 
      FractionBox["1", "2"], "0", "0", 
      FractionBox["1", "2"], "0", "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0", "0", 
      FractionBox["\[ImaginaryI]", "2"], "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0", "0", 
      FractionBox["\[ImaginaryI]", "2"], "0"},
     {
      FractionBox["1", "2"], "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}]},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0", "0", 
      FractionBox["\[ImaginaryI]", "2"], "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0", "0", 
      FractionBox["\[ImaginaryI]", "2"], "0", "0", "0"},
     {"0", "0", 
      FractionBox["1", "2"], "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], 
      FractionBox["1", "2"], "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], 
      FractionBox["\[ImaginaryI]", "2"], "0", "0", "0", "0", 
      FractionBox["\[ImaginaryI]", "2"], "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0", "0", 
      FractionBox["\[ImaginaryI]", "2"], "0", "0", 
      FractionBox["\[ImaginaryI]", "2"], "0", "0", "0"},
     {
      FractionBox["1", "2"], "0", "0", "0", "0", 
      FractionBox["1", "2"], "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}]},
     {"0", 
      FractionBox["1", "2"], "0", "0", 
      FractionBox["1", "2"], "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", 
      FractionBox["1", "2"], "0", "0", 
      FractionBox["1", "2"], "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0", "0", "0", "0", 
      FractionBox["\[ImaginaryI]", "2"], 
      FractionBox["\[ImaginaryI]", "2"], "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0", "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0", "0", 
      FractionBox["\[ImaginaryI]", "2"], "0", "0", "0", "0", "0", "0", 
      FractionBox["\[ImaginaryI]", "2"], "0", "0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", "2"]}], "0"},
     {
      FractionBox["1", "2"], "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "0", "0", "0", 
      FractionBox["1", "2"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {16, 16}, 0, {
     1, {{0, 4, 8, 12, 16, 20, 24, 28, 32, 36, 40, 44, 48, 52, 56, 60, 64}, {{
       1}, {6}, {11}, {16}, {2}, {5}, {12}, {15}, {3}, {8}, {9}, {14}, {4}, {
       7}, {10}, {13}, {2}, {5}, {12}, {15}, {1}, {6}, {11}, {16}, {4}, {7}, {
       10}, {13}, {3}, {8}, {9}, {14}, {3}, {8}, {9}, {14}, {4}, {7}, {10}, {
       13}, {1}, {6}, {11}, {16}, {2}, {5}, {12}, {15}, {4}, {7}, {10}, {
       13}, {3}, {8}, {9}, {14}, {2}, {5}, {12}, {15}, {1}, {6}, {11}, {
       16}}}, {Rational[1, 2], Rational[1, 2], Rational[1, 2], Rational[1, 2],
        Rational[1, 2], Rational[1, 2], Rational[1, 2], Rational[1, 2], 
       Rational[1, 2], Rational[1, 2], Rational[1, 2], Rational[1, 2], 
       Rational[1, 2], Rational[1, 2], Rational[1, 2], Rational[1, 2], 
       Complex[0, Rational[-1, 2]], Complex[0, Rational[1, 2]], Complex[
       0, Rational[-1, 2]], Complex[0, Rational[1, 2]], Rational[1, 2], 
       Rational[-1, 2], Rational[1, 2], Rational[-1, 2], Complex[
       0, Rational[-1, 2]], Complex[0, Rational[1, 2]], Complex[
       0, Rational[-1, 2]], Complex[0, Rational[1, 2]], Rational[1, 2], 
       Rational[-1, 2], Rational[1, 2], Rational[-1, 2], Complex[
       0, Rational[-1, 2]], Complex[0, Rational[-1, 2]], Complex[
       0, Rational[1, 2]], Complex[0, Rational[1, 2]], Complex[
       0, Rational[-1, 2]], Complex[0, Rational[-1, 2]], Complex[
       0, Rational[1, 2]], Complex[0, Rational[1, 2]], Rational[1, 2], 
       Rational[1, 2], Rational[-1, 2], Rational[-1, 2], Rational[1, 2], 
       Rational[1, 2], Rational[-1, 2], Rational[-1, 2], Rational[-1, 2], 
       Rational[1, 2], Rational[1, 2], Rational[-1, 2], Complex[
       0, Rational[-1, 2]], Complex[0, Rational[1, 2]], Complex[
       0, Rational[1, 2]], Complex[0, Rational[-1, 2]], Complex[
       0, Rational[-1, 2]], Complex[0, Rational[1, 2]], Complex[
       0, Rational[1, 2]], Complex[0, Rational[-1, 2]], Rational[1, 2], 
       Rational[-1, 2], Rational[-1, 2], Rational[1, 2]}}]]]]], "Output",
 CellChangeTimes->{3.6343439713560343`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BasisMatrix", "[", 
   RowBox[{
    RowBox[{"\"\<Col\>\"", "\[Rule]", "\"\<Pauli\>\""}], ",", "2"}], "]"}], 
  ".", 
  RowBox[{"Vec", "[", 
   RowBox[{"TP", "[", "II", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.634344025887267*^9, 3.6343440361013813`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.634344032334811*^9, 3.634344036782835*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Example 2", "Subsubsection",
 CellChangeTimes->{{3.634311079023025*^9, 3.634311079944573*^9}, {
  3.6343438732238092`*^9, 3.6343438734067183`*^9}}],

Cell["\<\
Transforming a col-vectorized Pauli-matrix into the Pauli vectorization basis:\
\>", "Text",
 CellChangeTimes->{{3.634343791707954*^9, 3.634343795964477*^9}, {
  3.634343834047625*^9, 3.634343856720357*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BasisTransformation", "[", 
  RowBox[{
   RowBox[{"Vec", "[", 
    RowBox[{"TP", "[", "X", "]"}], "]"}], ",", 
   RowBox[{"\"\<Col\>\"", "\[Rule]", "\"\<Pauli\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.634343696032118*^9, 3.634343785722336*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    SqrtBox["2"], "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6343437510755177`*^9, 3.634343786873967*^9}}]
}, Open  ]],

Cell["Compare this to straight vectorization in the Pauli basis", "Text",
 CellChangeTimes->{{3.634343801892969*^9, 3.6343438151893263`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Vec", "[", 
  RowBox[{
   RowBox[{"TP", "[", "X", "]"}], ",", 
   RowBox[{"Basis", "\[Rule]", "\"\<Pauli\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.634343816255982*^9, 3.634343825174858*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    SqrtBox["2"], "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.634343828610881*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 1000},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"10.0 for Linux x86 (64-bit) (June 27, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "ACom::usage"->{
  Cell[27523, 945, 3428, 141, 74, "Text",
   CellTags->"ACom::usage"]},
 "ArrayPermutations::usage"->{
  Cell[12225, 385, 810, 29, 32, "Text",
   CellTags->"ArrayPermutations::usage"]},
 "BasisLabels::usage"->{
  Cell[137461, 4622, 1431, 42, 149, "Text",
   CellTags->"BasisLabels::usage"]},
 "BasisMatrix::usage"->{
  Cell[184306, 6086, 3385, 95, 208, "Text",
   CellTags->"BasisMatrix::usage"]},
 "BasisTransformation::usage"->{
  Cell[187694, 6183, 1482, 45, 110, "Text",
   CellTags->"BasisTransformation::usage"]},
 "Basis::usage"->{
  Cell[112455, 3862, 2319, 73, 228, "Text",
   CellTags->"Basis::usage"]},
 "BlockMatrix::usage"->{
  Cell[18301, 599, 538, 17, 32, "Text",
   CellTags->"BlockMatrix::usage"]},
 "CircleTimes::usage"->{
  Cell[2558, 78, 2459, 81, 171, "Text",
   CellTags->"CircleTimes::usage"]},
 "Com::usage"->{
  Cell[24012, 800, 3508, 143, 53, "Text",
   CellTags->"Com::usage"]},
 "Devec::usage"->{
  Cell[168619, 5579, 1688, 49, 168, "Text",
   CellTags->"Devec::usage"]},
 "ExpressInBasis::usage"->{
  Cell[140626, 4710, 1920, 65, 209, "Text",
   CellTags->"ExpressInBasis::usage"]},
 "IdentityMatrixShorthand::usage"->{
  Cell[8665, 276, 1579, 40, 53, "Text",
   CellTags->"IdentityMatrixShorthand::usage"]},
 "MatrixContract::usage"->{
  Cell[104452, 3579, 1859, 65, 149, "Text",
   CellTags->"MatrixContract::usage"]},
 "MatrixPairContract::usage"->{
  Cell[108516, 3724, 1871, 67, 147, "Text",
   CellTags->"MatrixPairContract::usage"]},
 "MatrixToTensor::usage"->{
  Cell[49502, 1686, 2617, 103, 131, "Text",
   CellTags->"MatrixToTensor::usage"]},
 "MatrixTranspose::usage"->{
  Cell[58456, 2005, 1325, 37, 149, "Text",
   CellTags->"MatrixTranspose::usage"]},
 "OuterProduct::usage"->{
  Cell[33373, 1170, 914, 32, 32, "Text",
   CellTags->"OuterProduct::usage"]},
 "PartialTr::usage"->{
  Cell[94062, 3222, 2042, 70, 170, "Text",
   CellTags->"PartialTr::usage"]},
 "ProductIdentity::usage"->{
  Cell[175571, 5804, 2100, 67, 188, "Text",
   CellTags->"ProductIdentity::usage"]},
 "Projector::usage"->{
  Cell[34290, 1204, 818, 29, 32, "Text",
   CellTags->"Projector::usage"]},
 "Reravel::usage"->{
  Cell[90520, 3092, 2360, 86, 189, "Text",
   CellTags->"Reravel::usage"]},
 "Reshuffle::usage"->{
  Cell[77858, 2666, 3277, 111, 306, "Text",
   CellTags->"Reshuffle::usage"]},
 "SwapMatrix::usage"->{
  Cell[14924, 476, 1967, 72, 112, "Text",
   CellTags->"SwapMatrix::usage"]},
 "Swap::usage"->{
  Cell[65857, 2247, 3005, 118, 189, "Text",
   CellTags->"Swap::usage"]},
 "TensorPairContract::usage"->{
  Cell[101639, 3475, 1417, 52, 71, "Text",
   CellTags->"TensorPairContract::usage"]},
 "TP::usage"->{
  Cell[39148, 1368, 3801, 106, 315, "Text",
   CellTags->"TP::usage"]},
 "UnitArray::usage"->{
  Cell[21402, 705, 1195, 43, 53, "Text",
   CellTags->"UnitArray::usage"]},
 "Unravel::usage"->{
  Cell[85052, 2905, 2935, 105, 248, "Text",
   CellTags->"Unravel::usage"]},
 "Vec::usage"->{
  Cell[159918, 5298, 1718, 50, 168, "Text",
   CellTags->"Vec::usage"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"ACom::usage", 201447, 6585},
 {"ArrayPermutations::usage", 201550, 6588},
 {"BasisLabels::usage", 201658, 6591},
 {"BasisMatrix::usage", 201764, 6594},
 {"BasisTransformation::usage", 201878, 6597},
 {"Basis::usage", 201986, 6600},
 {"BlockMatrix::usage", 202086, 6603},
 {"CircleTimes::usage", 202188, 6606},
 {"Com::usage", 202282, 6609},
 {"Devec::usage", 202372, 6612},
 {"ExpressInBasis::usage", 202475, 6615},
 {"IdentityMatrixShorthand::usage", 202596, 6618},
 {"MatrixContract::usage", 202713, 6621},
 {"MatrixPairContract::usage", 202829, 6624},
 {"MatrixToTensor::usage", 202945, 6627},
 {"MatrixTranspose::usage", 203058, 6630},
 {"OuterProduct::usage", 203168, 6633},
 {"PartialTr::usage", 203270, 6636},
 {"ProductIdentity::usage", 203377, 6639},
 {"Projector::usage", 203485, 6642},
 {"Reravel::usage", 203582, 6645},
 {"Reshuffle::usage", 203681, 6648},
 {"SwapMatrix::usage", 203784, 6651},
 {"Swap::usage", 203880, 6654},
 {"TensorPairContract::usage", 203986, 6657},
 {"TP::usage", 204089, 6660},
 {"UnitArray::usage", 204184, 6663},
 {"Unravel::usage", 204281, 6666},
 {"Vec::usage", 204375, 6669}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 300, 4, 66, "Chapter"],
Cell[CellGroupData[{
Cell[905, 30, 144, 2, 65, "Section"],
Cell[1052, 34, 331, 5, 32, "Input"],
Cell[1386, 41, 182, 4, 31, "Text"],
Cell[1571, 47, 140, 2, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1748, 54, 110, 1, 65, "Section"],
Cell[1861, 57, 316, 6, 31, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2214, 68, 215, 3, 65, "Section"],
Cell[CellGroupData[{
Cell[2454, 75, 101, 1, 44, "Subsection"],
Cell[2558, 78, 2459, 81, 171, "Text",
 CellTags->"CircleTimes::usage"],
Cell[CellGroupData[{
Cell[5042, 163, 102, 1, 35, "Subsubsection"],
Cell[5147, 166, 111, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[5283, 171, 222, 6, 32, "Input"],
Cell[5508, 179, 214, 5, 32, "Output"]
}, Open  ]],
Cell[5737, 187, 109, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[5871, 192, 322, 8, 32, "Input"],
Cell[6196, 202, 1068, 25, 162, "Output"]
}, Open  ]],
Cell[7279, 230, 169, 2, 31, "Text"],
Cell[CellGroupData[{
Cell[7473, 236, 291, 7, 32, "Input"],
Cell[7767, 245, 683, 20, 94, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8511, 272, 151, 2, 45, "Subsection"],
Cell[8665, 276, 1579, 40, 53, "Text",
 CellTags->"IdentityMatrixShorthand::usage"],
Cell[CellGroupData[{
Cell[10269, 320, 98, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[10392, 325, 133, 2, 32, "Input"],
Cell[10528, 329, 401, 11, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10966, 345, 281, 6, 32, "Input"],
Cell[11250, 353, 780, 21, 94, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[12091, 381, 131, 2, 45, "Subsection"],
Cell[12225, 385, 810, 29, 32, "Text",
 CellTags->"ArrayPermutations::usage"],
Cell[CellGroupData[{
Cell[13060, 418, 98, 1, 35, "Subsubsection"],
Cell[13161, 421, 191, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[13377, 428, 364, 11, 32, "Input"],
Cell[13744, 441, 993, 24, 148, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14798, 472, 123, 2, 45, "Subsection"],
Cell[14924, 476, 1967, 72, 112, "Text",
 CellTags->"SwapMatrix::usage"],
Cell[CellGroupData[{
Cell[16916, 552, 98, 1, 35, "Subsubsection"],
Cell[17017, 555, 99, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[17141, 560, 239, 6, 28, "Input"],
Cell[17383, 568, 725, 20, 92, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18169, 595, 129, 2, 44, "Subsection"],
Cell[18301, 599, 538, 17, 32, "Text",
 CellTags->"BlockMatrix::usage"],
Cell[CellGroupData[{
Cell[18864, 620, 100, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[18989, 625, 545, 17, 28, "Input"],
Cell[19537, 644, 1655, 50, 126, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[21253, 701, 146, 2, 45, "Subsection"],
Cell[21402, 705, 1195, 43, 53, "Text",
 CellTags->"UnitArray::usage"],
Cell[CellGroupData[{
Cell[22622, 752, 99, 1, 35, "Subsubsection"],
Cell[22724, 755, 99, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[22848, 760, 289, 8, 28, "Input"],
Cell[23140, 770, 659, 19, 74, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23860, 796, 149, 2, 44, "Subsection"],
Cell[24012, 800, 3508, 143, 53, "Text",
 CellTags->"Com::usage"],
Cell[27523, 945, 3428, 141, 74, "Text",
 CellTags->"ACom::usage"],
Cell[CellGroupData[{
Cell[30976, 1090, 102, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[31103, 1095, 241, 6, 28, "Input"],
Cell[31347, 1103, 752, 21, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32136, 1129, 254, 7, 28, "Input"],
Cell[32393, 1138, 752, 21, 58, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33206, 1166, 164, 2, 45, "Subsection"],
Cell[33373, 1170, 914, 32, 32, "Text",
 CellTags->"OuterProduct::usage"],
Cell[34290, 1204, 818, 29, 32, "Text",
 CellTags->"Projector::usage"],
Cell[CellGroupData[{
Cell[35133, 1237, 100, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[35258, 1242, 306, 8, 28, "Input"],
Cell[35567, 1252, 1191, 34, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36795, 1291, 262, 7, 28, "Input"],
Cell[37060, 1300, 1784, 52, 80, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[38917, 1360, 106, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[39048, 1365, 97, 1, 44, "Subsection"],
Cell[39148, 1368, 3801, 106, 315, "Text",
 CellTags->"TP::usage"],
Cell[CellGroupData[{
Cell[42974, 1478, 102, 1, 35, "Subsubsection"],
Cell[43079, 1481, 138, 2, 28, "Input"],
Cell[43220, 1485, 4126, 122, 391, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[47383, 1612, 147, 2, 29, "Subsubsection"],
Cell[CellGroupData[{
Cell[47555, 1618, 233, 5, 28, "Input"],
Cell[47791, 1625, 862, 25, 92, "Output"]
}, Open  ]],
Cell[48668, 1653, 163, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[48856, 1660, 166, 4, 28, "Input"],
Cell[49025, 1666, 158, 4, 28, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[49256, 1678, 112, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[49393, 1683, 106, 1, 44, "Subsection"],
Cell[49502, 1686, 2617, 103, 131, "Text",
 CellTags->"MatrixToTensor::usage"],
Cell[CellGroupData[{
Cell[52144, 1793, 98, 1, 35, "Subsubsection"],
Cell[52245, 1796, 158, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[52428, 1803, 486, 14, 46, "Input"],
Cell[52917, 1819, 2574, 80, 80, "Output"],
Cell[55494, 1901, 95, 1, 28, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[55638, 1908, 102, 1, 29, "Subsubsection"],
Cell[55743, 1911, 125, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[55893, 1916, 378, 10, 46, "Input"],
Cell[56274, 1928, 1940, 64, 80, "Output"],
Cell[58217, 1994, 72, 1, 28, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[58350, 2002, 103, 1, 44, "Subsection"],
Cell[58456, 2005, 1325, 37, 149, "Text",
 CellTags->"MatrixTranspose::usage"],
Cell[CellGroupData[{
Cell[59806, 2046, 102, 1, 35, "Subsubsection"],
Cell[59911, 2049, 159, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[60095, 2056, 651, 19, 46, "Input"],
Cell[60749, 2077, 3143, 100, 92, "Output"]
}, Open  ]],
Cell[63907, 2180, 97, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[64029, 2185, 946, 30, 65, "Input"],
Cell[64978, 2217, 725, 20, 92, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[65764, 2244, 90, 1, 44, "Subsection"],
Cell[65857, 2247, 3005, 118, 189, "Text",
 CellTags->"Swap::usage"],
Cell[CellGroupData[{
Cell[68887, 2369, 149, 2, 35, "Subsubsection"],
Cell[69039, 2373, 101, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[69165, 2378, 568, 17, 46, "Input"],
Cell[69736, 2397, 6275, 202, 126, "Output"]
}, Open  ]],
Cell[76026, 2602, 111, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[76162, 2607, 818, 26, 46, "Input"],
Cell[76983, 2635, 712, 21, 46, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[77756, 2663, 99, 1, 44, "Subsection"],
Cell[77858, 2666, 3277, 111, 306, "Text",
 CellTags->"Reshuffle::usage"],
Cell[CellGroupData[{
Cell[81160, 2781, 98, 1, 35, "Subsubsection"],
Cell[81261, 2784, 1048, 25, 119, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[82346, 2814, 100, 1, 29, "Subsubsection"],
Cell[82449, 2817, 153, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[82627, 2824, 575, 17, 46, "Input"],
Cell[83205, 2843, 465, 12, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83707, 2860, 697, 20, 46, "Input"],
Cell[84407, 2882, 486, 13, 28, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[84954, 2902, 95, 1, 44, "Subsection"],
Cell[85052, 2905, 2935, 105, 248, "Text",
 CellTags->"Unravel::usage"],
Cell[CellGroupData[{
Cell[88012, 3014, 98, 1, 35, "Subsubsection"],
Cell[88113, 3017, 983, 25, 135, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[89133, 3047, 98, 1, 29, "Subsubsection"],
Cell[CellGroupData[{
Cell[89256, 3052, 786, 21, 46, "Input"],
Cell[90045, 3075, 316, 7, 28, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[90422, 3089, 95, 1, 44, "Subsection"],
Cell[90520, 3092, 2360, 86, 189, "Text",
 CellTags->"Reravel::usage"],
Cell[CellGroupData[{
Cell[92905, 3182, 99, 1, 35, "Subsubsection"],
Cell[93007, 3185, 124, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[93156, 3190, 302, 8, 28, "Input"],
Cell[93461, 3200, 290, 6, 28, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[93824, 3214, 111, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[93960, 3219, 99, 1, 44, "Subsection"],
Cell[94062, 3222, 2042, 70, 170, "Text",
 CellTags->"PartialTr::usage"],
Cell[CellGroupData[{
Cell[96129, 3296, 102, 1, 35, "Subsubsection"],
Cell[96234, 3299, 200, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[96459, 3307, 449, 12, 28, "Input"],
Cell[96911, 3321, 3167, 101, 92, "Output"]
}, Open  ]],
Cell[100093, 3425, 144, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[100262, 3430, 452, 12, 28, "Input"],
Cell[100717, 3444, 752, 21, 74, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[101530, 3472, 106, 1, 44, "Subsection"],
Cell[101639, 3475, 1417, 52, 71, "Text",
 CellTags->"TensorPairContract::usage"],
Cell[CellGroupData[{
Cell[103081, 3531, 100, 1, 35, "Subsubsection"],
Cell[103184, 3534, 139, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[103348, 3539, 863, 27, 63, "Input"],
Cell[104214, 3568, 70, 1, 28, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[104345, 3576, 104, 1, 44, "Subsection"],
Cell[104452, 3579, 1859, 65, 149, "Text",
 CellTags->"MatrixContract::usage"],
Cell[CellGroupData[{
Cell[106336, 3648, 100, 1, 35, "Subsubsection"],
Cell[106439, 3651, 162, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[106626, 3658, 447, 14, 46, "Input"],
Cell[107076, 3674, 1269, 40, 92, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[108406, 3721, 107, 1, 44, "Subsection"],
Cell[108516, 3724, 1871, 67, 147, "Text",
 CellTags->"MatrixPairContract::usage"],
Cell[CellGroupData[{
Cell[110412, 3795, 99, 1, 35, "Subsubsection"],
Cell[110514, 3798, 139, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[110678, 3803, 1308, 38, 97, "Input"],
Cell[111989, 3843, 171, 3, 28, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[112233, 3854, 101, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[112359, 3859, 93, 1, 44, "Subsection"],
Cell[112455, 3862, 2319, 73, 228, "Text",
 CellTags->"Basis::usage"],
Cell[CellGroupData[{
Cell[114799, 3939, 153, 2, 35, "Subsubsection"],
Cell[114955, 3943, 115, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[115095, 3948, 220, 4, 28, "Input"],
Cell[115318, 3954, 2991, 90, 67, "Output"]
}, Open  ]],
Cell[118324, 4047, 122, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[118471, 4052, 194, 4, 28, "Input"],
Cell[118668, 4058, 11822, 331, 318, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[130539, 4395, 100, 1, 29, "Subsubsection"],
Cell[130642, 4398, 211, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[130878, 4406, 513, 15, 28, "Input"],
Cell[131394, 4423, 1659, 51, 67, "Output"]
}, Open  ]],
Cell[133068, 4477, 170, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[133263, 4483, 552, 17, 28, "Input"],
Cell[133818, 4502, 3480, 110, 113, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[137359, 4619, 99, 1, 44, "Subsection"],
Cell[137461, 4622, 1431, 42, 149, "Text",
 CellTags->"BasisLabels::usage"],
Cell[CellGroupData[{
Cell[138917, 4668, 98, 1, 35, "Subsubsection"],
Cell[139018, 4671, 122, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[139165, 4676, 164, 3, 28, "Input"],
Cell[139332, 4681, 1129, 19, 46, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[140522, 4707, 101, 1, 44, "Subsection"],
Cell[140626, 4710, 1920, 65, 209, "Text",
 CellTags->"ExpressInBasis::usage"],
Cell[CellGroupData[{
Cell[142571, 4779, 100, 1, 35, "Subsubsection"],
Cell[142674, 4782, 1506, 36, 199, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[144217, 4823, 100, 1, 29, "Subsubsection"],
Cell[144320, 4826, 124, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[144469, 4831, 280, 8, 28, "Input"],
Cell[144752, 4841, 6797, 203, 296, "Output"]
}, Open  ]],
Cell[151564, 5047, 117, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[151706, 5052, 354, 10, 46, "Input"],
Cell[152063, 5064, 7514, 217, 296, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[159650, 5289, 98, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[159773, 5294, 142, 2, 44, "Subsection"],
Cell[159918, 5298, 1718, 50, 168, "Text",
 CellTags->"Vec::usage"],
Cell[CellGroupData[{
Cell[161661, 5352, 98, 1, 35, "Subsubsection"],
Cell[161762, 5355, 1364, 32, 139, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[163163, 5392, 149, 2, 29, "Subsubsection"],
Cell[163315, 5396, 168, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[163508, 5402, 269, 8, 28, "Input"],
Cell[163780, 5412, 909, 28, 92, "Output"]
}, Open  ]],
Cell[164704, 5443, 138, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[164867, 5448, 344, 10, 28, "Input"],
Cell[165214, 5460, 881, 28, 92, "Output"]
}, Open  ]],
Cell[166110, 5491, 182, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[166317, 5497, 344, 10, 28, "Input"],
Cell[166664, 5509, 1699, 58, 136, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[168424, 5574, 192, 3, 44, "Subsection"],
Cell[168619, 5579, 1688, 49, 168, "Text",
 CellTags->"Devec::usage"],
Cell[CellGroupData[{
Cell[170332, 5632, 98, 1, 35, "Subsubsection"],
Cell[170433, 5635, 120, 1, 30, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[170590, 5641, 149, 2, 35, "Subsubsection"],
Cell[170742, 5645, 202, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[170969, 5653, 266, 6, 28, "Input"],
Cell[171238, 5661, 809, 23, 58, "Output"]
}, Open  ]],
Cell[172062, 5687, 138, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[172225, 5692, 342, 9, 28, "Input"],
Cell[172570, 5703, 777, 22, 58, "Output"]
}, Open  ]],
Cell[173362, 5728, 182, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[173569, 5734, 340, 9, 28, "Input"],
Cell[173912, 5745, 1467, 48, 80, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[175440, 5800, 128, 2, 44, "Subsection"],
Cell[175571, 5804, 2100, 67, 188, "Text",
 CellTags->"ProductIdentity::usage"],
Cell[CellGroupData[{
Cell[177696, 5875, 98, 1, 35, "Subsubsection"],
Cell[177797, 5878, 93, 1, 30, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[177927, 5884, 148, 2, 29, "Subsubsection"],
Cell[178078, 5888, 117, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[178220, 5893, 1114, 36, 80, "Input"],
Cell[179337, 5931, 4535, 136, 92, "Output"],
Cell[183875, 6069, 257, 7, 28, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[184193, 6083, 110, 1, 44, "Subsection"],
Cell[184306, 6086, 3385, 95, 208, "Text",
 CellTags->"BasisMatrix::usage"],
Cell[187694, 6183, 1482, 45, 110, "Text",
 CellTags->"BasisTransformation::usage"],
Cell[CellGroupData[{
Cell[189201, 6232, 101, 1, 35, "Subsubsection"],
Cell[189305, 6235, 272, 5, 49, "Text"],
Cell[CellGroupData[{
Cell[189602, 6244, 218, 5, 28, "Input"],
Cell[189823, 6251, 1133, 38, 132, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[190993, 6294, 316, 7, 28, "Input"],
Cell[191312, 6303, 269, 8, 37, "Output"]
}, Open  ]],
Cell[191596, 6314, 139, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[191760, 6319, 243, 6, 28, "Input"],
Cell[192006, 6327, 6445, 150, 424, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[198488, 6482, 296, 8, 28, "Input"],
Cell[198787, 6492, 663, 19, 46, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[199499, 6517, 153, 2, 29, "Subsubsection"],
Cell[199655, 6521, 217, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[199897, 6529, 275, 6, 28, "Input"],
Cell[200175, 6537, 271, 8, 37, "Output"]
}, Open  ]],
Cell[200461, 6548, 141, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[200627, 6553, 221, 5, 28, "Input"],
Cell[200851, 6560, 245, 8, 37, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
